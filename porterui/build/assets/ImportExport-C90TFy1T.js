import{c as E,j as s,r as y,B as a,T as i,g as t,aP as w,w as W,X as I,b as l,d as O,aM as $,a6 as L,a7 as x,L as p,o as d}from"./index-DsbQFb1R.js";import{D as k}from"./Download-Dd0XYCVr.js";import{G as R}from"./Group-BQ_CR5Fh.js";import{C as u}from"./CheckCircle-DTYTWwS_.js";const C=E(s.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"})),U=()=>{const[j,o]=y.useState(null),[r,v]=y.useState(null),g=y.useRef(null),m=async(c="all")=>{try{const n=await(await fetch(`/api/export?what=${c}`)).json(),b=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),f=URL.createObjectURL(b),e=document.createElement("a");e.href=f,e.download=`porter-export-${c}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(f),o({type:"success",text:"Configuration exported successfully"})}catch{o({type:"error",text:"Failed to export configuration"})}},S=async c=>{const h=c.target.files[0];if(h){try{const n=await h.text(),b=JSON.parse(n),e=await(await fetch("/api/import",{method:"POST",headers:{"Content-Type":"application/json"},body:n})).json();e.success?(v(e.imported),o({type:"success",text:"Configuration imported successfully"})):o({type:"error",text:e.error||"Import failed"})}catch(n){o({type:"error",text:"Invalid import file: "+n.message})}c.target.value=""}};return s.jsxs(a,{sx:{p:3},children:[s.jsxs(i,{variant:"h5",sx:{color:t.text.primary,fontWeight:700,mb:3,display:"flex",alignItems:"center",gap:1},children:[s.jsx(w,{sx:{color:t.primary}}),"Import / Export"]}),j&&s.jsx(W,{severity:j.type,onClose:()=>o(null),sx:{mb:3},children:j.text}),s.jsxs(a,{sx:{display:"flex",gap:3,flexWrap:"wrap"},children:[s.jsxs(I,{sx:{background:t.background.card,border:`1px solid ${t.border.light}`,p:3,flex:1,minWidth:300},children:[s.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[s.jsx(k,{sx:{color:t.secondary}}),s.jsx(i,{sx:{color:t.text.primary,fontWeight:600},children:"Export Configuration"})]}),s.jsx(i,{sx:{color:t.text.secondary,mb:3,fontSize:"0.9rem"},children:"Export your Porter configuration to a JSON file for backup or migration."}),s.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s.jsx(l,{variant:"contained",startIcon:s.jsx(k,{}),onClick:()=>m("all"),fullWidth:!0,sx:{background:t.primary,justifyContent:"flex-start"},children:"Export All"}),s.jsx(l,{variant:"outlined",startIcon:s.jsx(O,{}),onClick:()=>m("machines"),fullWidth:!0,sx:{justifyContent:"flex-start"},children:"Export Machines Only"}),s.jsx(l,{variant:"outlined",startIcon:s.jsx(R,{}),onClick:()=>m("groups"),fullWidth:!0,sx:{justifyContent:"flex-start"},children:"Export Groups Only"}),s.jsx(l,{variant:"outlined",startIcon:s.jsx($,{}),onClick:()=>m("backup_jobs"),fullWidth:!0,sx:{justifyContent:"flex-start"},children:"Export Backup Jobs Only"})]})]}),s.jsxs(I,{sx:{background:t.background.card,border:`1px solid ${t.border.light}`,p:3,flex:1,minWidth:300},children:[s.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[s.jsx(C,{sx:{color:t.primary}}),s.jsx(i,{sx:{color:t.text.primary,fontWeight:600},children:"Import Configuration"})]}),s.jsx(i,{sx:{color:t.text.secondary,mb:3,fontSize:"0.9rem"},children:"Import a previously exported Porter configuration file."}),s.jsx("input",{type:"file",accept:".json",ref:g,onChange:S,style:{display:"none"}}),s.jsx(l,{variant:"contained",startIcon:s.jsx(C,{}),onClick:()=>g.current?.click(),fullWidth:!0,sx:{background:t.primary,mb:2},children:"Select File to Import"}),r&&s.jsxs(a,{sx:{mt:2},children:[s.jsx(i,{sx:{color:t.text.muted,fontSize:"0.85rem",mb:1},children:"Imported:"}),s.jsxs(L,{dense:!0,children:[r.machines>0&&s.jsxs(x,{children:[s.jsx(p,{children:s.jsx(u,{sx:{color:t.secondary}})}),s.jsx(d,{primary:`${r.machines} machines`})]}),r.groups>0&&s.jsxs(x,{children:[s.jsx(p,{children:s.jsx(u,{sx:{color:t.secondary}})}),s.jsx(d,{primary:`${r.groups} groups`})]}),r.bookmarks>0&&s.jsxs(x,{children:[s.jsx(p,{children:s.jsx(u,{sx:{color:t.secondary}})}),s.jsx(d,{primary:`${r.bookmarks} bookmarks`})]}),r.ssh_keys>0&&s.jsxs(x,{children:[s.jsx(p,{children:s.jsx(u,{sx:{color:t.secondary}})}),s.jsx(d,{primary:`${r.ssh_keys} SSH keys`})]}),r.backup_jobs>0&&s.jsxs(x,{children:[s.jsx(p,{children:s.jsx(u,{sx:{color:t.secondary}})}),s.jsx(d,{primary:`${r.backup_jobs} backup jobs`})]})]})]})]})]})]})};export{U as default};

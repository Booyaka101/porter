import{c as Z,j as e,u as Ce,a as ze,r as p,B as r,s as ve,T as o,R as le,b as L,C as Ie,d as P,e as N,f as U,g as t,P as Re,h as $e,A as _e,H as G,N as Me,i as We}from"./index-C5leRk9Z.js";import{S as E}from"./Schedule-DussFqxI.js";import{C as De}from"./CheckCircle-C0o_mcca.js";import{W as Ae}from"./Wifi-Di59onVm.js";import{T as Fe}from"./TrendingUp-BnshQfhq.js";import{A as He}from"./AccessTime-C3z1lcrZ.js";import{S as ce}from"./Storage-Ck4ud2Qk.js";import{M as de}from"./Memory-Dh06HvTo.js";import{S as xe}from"./Speed-DjummGD9.js";import{S as K,R as Le}from"./Skeleton-C493seKy.js";import{A as Ee}from"./AutoAwesome-Bd7IZTcd.js";import{C as Y}from"./Chip-DbK6i-5d.js";import{G as u}from"./Grid-Ff5obvXY.js";import{L as A}from"./LinearProgress-LvlAHztZ.js";const Oe=Z(e.jsx("path",{d:"M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66s.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21"})),X=Z(e.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"})),Pe=Z(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4c-1.48 0-2.85.43-4.01 1.17l1.46 1.46C10.21 6.23 11.08 6 12 6c3.04 0 5.5 2.46 5.5 5.5v.5H19c1.66 0 3 1.34 3 3 0 1.13-.64 2.11-1.56 2.62l1.45 1.45C23.16 18.16 24 16.68 24 15c0-2.64-2.05-4.78-4.65-4.96M3 5.27l2.75 2.74C2.56 8.15 0 10.77 0 14c0 3.31 2.69 6 6 6h11.73l2 2L21 20.73 4.27 4zM7.73 10l8 8H6c-2.21 0-4-1.79-4-4s1.79-4 4-4z"})),T=({icon:n,title:k,value:h,subtitle:b,color:x,trend:f,onClick:S,glowColor:C})=>e.jsx(N,{onClick:S,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"16px",cursor:S?"pointer":"default",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",height:140,position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:`linear-gradient(90deg, ${x}, ${C||x})`,opacity:.8},"&:hover":S?{transform:"translateY(-4px)",background:"linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",borderColor:`${x}40`,boxShadow:`0 8px 32px ${x}20`}:{}},children:e.jsxs(U,{sx:{p:2.5,height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(r,{sx:{width:42,height:42,borderRadius:"12px",background:`${x}15`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(n,{sx:{color:x,fontSize:22}})}),f!==void 0&&e.jsx(Y,{label:`${f>0?"+":""}${f}%`,size:"small",sx:{background:f>=0?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",color:f>=0?"#22c55e":"#ef4444",height:22,fontSize:"0.75rem"}})]}),e.jsxs(r,{children:[e.jsx(o,{sx:{fontSize:"1.75rem",fontWeight:600,color:"#fafafa",lineHeight:1},children:h}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",mt:.5},children:k})]})]})}),Te=({execution:n,onClick:k})=>{const h=b=>{const x=Math.floor((new Date-new Date(b))/1e3);return x<60?"Just now":x<3600?`${Math.floor(x/60)}m ago`:x<86400?`${Math.floor(x/3600)}h ago`:`${Math.floor(x/86400)}d ago`};return e.jsxs(r,{onClick:k,sx:{display:"flex",alignItems:"center",gap:2,p:2,borderBottom:"1px solid rgba(255,255,255,0.05)",cursor:"pointer",transition:"all 0.2s","&:hover":{background:"rgba(255,255,255,0.03)"},"&:last-child":{borderBottom:"none"}},children:[e.jsx(r,{sx:{width:10,height:10,borderRadius:"50%",background:n.success?t.secondary:t.error,boxShadow:`0 0 10px ${n.success?t.secondary:t.error}`,flexShrink:0}}),e.jsxs(r,{sx:{flex:1,minWidth:0},children:[e.jsx(o,{sx:{color:t.text.primary,fontWeight:500,fontSize:"1rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.script_name}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.85rem"},children:n.machine_name})]}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.85rem",fontFamily:"monospace"},children:h(n.started_at)})]})},Ne=({job:n})=>{const k=h=>{if(!h||h==="0001-01-01T00:00:00Z")return"Not scheduled";const b=new Date(h),f=b-new Date;return f<0?"Overdue":f<36e5?`In ${Math.floor(f/6e4)} min`:f<864e5?`In ${Math.floor(f/36e5)} hours`:b.toLocaleDateString()};return e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,p:2,borderRadius:"10px",background:"rgba(255,255,255,0.02)"},children:[e.jsx(r,{sx:{width:36,height:36,borderRadius:"8px",background:n.enabled?"rgba(249, 115, 22, 0.1)":"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(E,{sx:{color:n.enabled?"#f97316":"rgba(255,255,255,0.3)",fontSize:18}})}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(o,{sx:{color:t.text.primary,fontWeight:500,fontSize:"0.9rem"},children:n.name}),e.jsxs(o,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[n.machine_ids?.length||0," machines"]})]}),e.jsx(Y,{label:k(n.next_run),size:"small",sx:{background:"rgba(249, 115, 22, 0.1)",color:"#f97316",fontSize:"0.75rem",height:24}})]})},F=({icon:n,label:k,color:h,onClick:b,description:x})=>e.jsxs(L,{onClick:b,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:1,p:3,borderRadius:"16px",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)",flex:1,minWidth:140,minHeight:100,textTransform:"none",transition:"all 0.2s ease","&:hover":{background:`${h}15`,borderColor:`${h}40`,transform:"translateY(-2px)"}},children:[e.jsx(n,{sx:{color:h,fontSize:32}}),e.jsx(o,{sx:{color:"#fafafa",fontSize:"0.9rem",fontWeight:500},children:k}),x&&e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.75rem"},children:x})]}),Ue=({healthData:n,machines:k,navigate:h})=>{const b=[],x=k.filter(c=>!n[c.id]?.online&&c.status!=="offline");x.length>0&&b.push({type:"error",icon:Pe,message:`${x.length} machine${x.length>1?"s":""} offline`,details:x.map(c=>c.name).join(", "),action:()=>h("/machines")});const f=Object.entries(n).filter(([c,a])=>a?.online?parseFloat(a.cpu_usage?.replace("%","")||a.load_avg?.split(" ")[0]||"0")>90:!1);f.length>0&&b.push({type:"warning",icon:xe,message:`High CPU on ${f.length} machine${f.length>1?"s":""}`,details:f.map(([c,a])=>`${a.machine_name||c}: ${a.cpu_usage||a.load_avg}`).join(", "),action:()=>h("/machines")});const S=Object.entries(n).filter(([c,a])=>a?.online?parseFloat(a.disk_usage?.replace("%","")||"0")>90:!1);S.length>0&&b.push({type:"error",icon:ce,message:`Low disk space on ${S.length} machine${S.length>1?"s":""}`,details:S.map(([c,a])=>`${a.machine_name||c}: ${a.disk_usage}`).join(", "),action:()=>h("/machines")});const C=Object.entries(n).filter(([c,a])=>a?.online?parseFloat(a.memory_usage?.replace("%","")||"0")>90:!1);return C.length>0&&b.push({type:"warning",icon:de,message:`High memory on ${C.length} machine${C.length>1?"s":""}`,details:C.map(([c,a])=>`${a.machine_name||c}: ${a.memory_usage}`).join(", "),action:()=>h("/machines")}),b.length===0?null:e.jsx(r,{sx:{mb:3,display:"flex",flexDirection:"column",gap:1.5},children:b.map((c,a)=>e.jsxs(r,{onClick:c.action,sx:{display:"flex",alignItems:"center",gap:2,p:2,borderRadius:"12px",cursor:"pointer",background:c.type==="error"?"linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.05) 100%)":"linear-gradient(135deg, rgba(234, 179, 8, 0.15) 0%, rgba(234, 179, 8, 0.05) 100%)",border:`1px solid ${c.type==="error"?"rgba(239, 68, 68, 0.3)":"rgba(234, 179, 8, 0.3)"}`,transition:"all 0.2s ease","&:hover":{transform:"translateX(4px)",borderColor:c.type==="error"?"rgba(239, 68, 68, 0.5)":"rgba(234, 179, 8, 0.5)"}},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"10px",background:c.type==="error"?"rgba(239, 68, 68, 0.2)":"rgba(234, 179, 8, 0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(c.icon,{sx:{color:c.type==="error"?"#ef4444":"#eab308",fontSize:22}})}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(o,{sx:{color:c.type==="error"?"#ef4444":"#eab308",fontWeight:600,fontSize:"0.95rem"},children:c.message}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c.details})]}),e.jsx(X,{sx:{color:c.type==="error"?"#ef4444":"#eab308",fontSize:20}})]},a))})},Q=({data:n,color:k,height:h=30})=>{if(!n||n.length<2)return null;const b=Math.max(...n),x=Math.min(...n),f=b-x||1,S=n.map((C,c)=>{const a=c/(n.length-1)*100,_=h-(C-x)/f*h;return`${a},${_}`}).join(" ");return e.jsxs("svg",{width:"100%",height:h,style:{overflow:"visible"},children:[e.jsx("polyline",{points:S,fill:"none",stroke:k,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"100",cy:h-(n[n.length-1]-x)/f*h,r:"3",fill:k})]})},lr=()=>{const n=Ce(),{canExecute:k,canWrite:h,canAccessFiles:b,canAccessTools:x,isViewerOnly:f}=ze(),S=k(),C=h("machines"),c=f(),[a,_]=p.useState(!0),[w,ge]=p.useState({machines:{total:0,online:0},scripts:{total:0,custom:0},jobs:{total:0,enabled:0},executions:{total:0,success:0,today:0}}),[q,he]=p.useState([]),[ee,ue]=p.useState([]),[I,fe]=p.useState([]),[z,B]=p.useState({}),[Ye,pe]=p.useState({enabled:!0,interval_mins:5,running:!1}),[Be,Je]=p.useState(!1),[re,se]=p.useState(!1),[me,be]=p.useState(new Date),[v,je]=p.useState(!0),[W,ye]=p.useState({cpu:[],memory:[],disk:[]}),D=p.useCallback(async()=>{_(!0);try{const[s,j,i,y,l,g,d]=await Promise.all([fetch("/api/machines"),fetch("/api/scripts"),fetch("/api/custom-scripts"),fetch("/api/scheduler/jobs"),fetch("/api/history?limit=10"),fetch("/api/history/stats"),fetch("/api/health/cached")]),m=await s.json()||[],R=await j.json()||[],M=await i.json()||[],V=await y.json()||[],ne=await l.json()||[],oe=await g.json()||{},ie=await d.json()||{},ke=m.filter($=>ie[$.id]?.online||$.status==="online").length,Se=V.filter($=>$.enabled).length,ae=new Date;ae.setHours(0,0,0,0);const we=ne.filter($=>new Date($.started_at)>=ae).length;ge({machines:{total:m.length,online:ke},scripts:{total:R.length,custom:M.length},jobs:{total:V.length,enabled:Se},executions:{total:oe.total||0,success:oe.successful||0,today:we}}),he(ne.slice(0,5)),ue(V.filter($=>$.enabled).slice(0,3)),fe(m),B(ie)}catch(s){console.error("Failed to load dashboard data:",s)}_(!1)},[]),te=p.useCallback(async()=>{try{const j=await(await fetch("/api/health/poller/config")).json();pe(j)}catch(s){console.error("Failed to load health poller config:",s)}},[]),J=p.useCallback(async()=>{se(!0);try{const j=await(await fetch("/api/health",{method:"GET"})).json()||{};B(j),D()}catch(s){console.error("Failed to run health check:",s)}se(!1)},[D]);p.useEffect(()=>{D(),te(),J()},[D,te,J]),p.useEffect(()=>{if(!v)return;const s=setInterval(D,3e4);return()=>clearInterval(s)},[v,D]);const H=p.useRef([]);p.useEffect(()=>{if(H.current.forEach(i=>{(i.readyState===WebSocket.OPEN||i.readyState===WebSocket.CONNECTING)&&i.close()}),H.current=[],I.length===0)return;const s=I.filter(i=>i.has_agent&&i.agent_port);let j=!0;return s.forEach(i=>{try{const y=`ws://${i.ip}:${i.agent_port}/ws`,l=new WebSocket(y);l.onmessage=g=>{if(j)try{const d=JSON.parse(g.data);d.type==="metrics"&&B(m=>({...m,[i.id]:{...m[i.id],machine_id:i.id,machine_name:i.name,ip:i.ip,online:!0,last_checked:new Date().toISOString(),cpu_usage:d.metrics?.cpu_usage?`${d.metrics.cpu_usage.toFixed(1)}%`:m[i.id]?.cpu_usage,memory_usage:d.metrics?.memory_usage?`${d.metrics.memory_usage.toFixed(1)}%`:m[i.id]?.memory_usage,disk_usage:d.metrics?.disk_usage?`${d.metrics.disk_usage.toFixed(1)}%`:m[i.id]?.disk_usage,load_avg:d.metrics?.load_average||m[i.id]?.load_avg,uptime:d.metrics?.uptime||m[i.id]?.uptime}}))}catch{}},H.current.push(l)}catch{}}),()=>{j=!1,H.current.forEach(i=>{(i.readyState===WebSocket.OPEN||i.readyState===WebSocket.CONNECTING)&&i.close()}),H.current=[]}},[I]);const O=w.executions.total>0?Math.round(w.executions.success/w.executions.total*100):0;return p.useEffect(()=>{a||be(new Date)},[a]),p.useEffect(()=>{if(Object.keys(z).length===0)return;const s=Object.values(z).filter(l=>l.online);if(s.length===0)return;const j=Math.round(s.reduce((l,g)=>{const d=parseFloat(g.cpu_usage?.replace("%","")||g.load_avg?.split(" ")[0]||"0");return l+d},0)/s.length),i=Math.round(s.reduce((l,g)=>{const d=parseFloat(g.memory_usage?.replace("%","")||"0");return l+d},0)/s.length),y=Math.round(s.reduce((l,g)=>{const d=parseFloat(g.disk_usage?.replace("%","")||"0");return l+d},0)/s.length);ye(l=>({cpu:[...l.cpu.slice(-19),j],memory:[...l.memory.slice(-19),i],disk:[...l.disk.slice(-19),y]}))},[z]),e.jsxs(r,{sx:ve.pageContainer,children:[e.jsx(r,{sx:{mb:4,p:3,borderRadius:"20px",background:"linear-gradient(135deg, rgba(249, 115, 22, 0.08) 0%, rgba(34, 197, 94, 0.05) 50%, rgba(139, 92, 246, 0.05) 100%)",border:"1px solid rgba(255,255,255,0.06)",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(249, 115, 22, 0.5), rgba(34, 197, 94, 0.5), transparent)"}},children:e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[e.jsxs(r,{children:[e.jsx(o,{sx:{fontSize:"2rem",fontWeight:700,background:"linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.8) 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:.5,letterSpacing:"-0.02em"},children:"Dashboard"}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.95rem"},children:"Real-time overview of your infrastructure"})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,px:2,py:.75,borderRadius:"10px",background:"rgba(0,0,0,0.2)"},children:[e.jsx(He,{sx:{fontSize:16,color:"rgba(255,255,255,0.4)"}}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.85rem",fontFamily:"monospace"},children:me.toLocaleTimeString()})]}),e.jsx(Y,{icon:v?e.jsx(Oe,{sx:{fontSize:14,color:"#22c55e"}}):e.jsx(le,{sx:{fontSize:14}}),label:v?"Live":"Paused",size:"small",onClick:()=>je(!v),sx:{background:v?"rgba(34, 197, 94, 0.15)":"rgba(255,255,255,0.05)",color:v?"#22c55e":"rgba(255,255,255,0.4)",cursor:"pointer",fontWeight:600,border:v?"1px solid rgba(34, 197, 94, 0.3)":"1px solid rgba(255,255,255,0.1)","&:hover":{background:v?"rgba(34, 197, 94, 0.2)":"rgba(255,255,255,0.08)"}}}),e.jsx(L,{size:"small",startIcon:re?e.jsx(Ie,{size:14}):e.jsx(le,{}),onClick:J,disabled:re,sx:{textTransform:"none",background:"linear-gradient(135deg, rgba(249, 115, 22, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(249, 115, 22, 0.3)",color:"#f97316",fontWeight:600,borderRadius:"10px","&:hover":{background:"linear-gradient(135deg, rgba(249, 115, 22, 0.25) 0%, rgba(249, 115, 22, 0.15) 100%)",borderColor:"rgba(249, 115, 22, 0.5)"}},children:"Refresh"})]})]})}),e.jsx(Ue,{healthData:z,machines:I,navigate:n}),e.jsxs(r,{sx:{mb:4},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2.5},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"12px",background:"linear-gradient(135deg, rgba(34, 197, 94, 0.2) 0%, rgba(34, 197, 94, 0.1) 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(34, 197, 94, 0.2)"},children:e.jsx(P,{sx:{color:"#22c55e",fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"#fafafa",fontWeight:600,fontSize:"1.15rem"},children:"Online Machines"}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.8rem"},children:"Active deployment targets"})]})]}),e.jsx(Y,{icon:e.jsx(Ae,{sx:{fontSize:14,color:"#22c55e"}}),label:`${I.filter(s=>z[s.id]?.online===!0).length} / ${I.length}`,size:"small",sx:{background:"rgba(34, 197, 94, 0.1)",color:"#22c55e",fontSize:"0.85rem",height:30,border:"1px solid rgba(34, 197, 94, 0.2)",fontWeight:600}})]}),e.jsx(u,{container:!0,spacing:2,children:a?[1,2,3,4].map(s=>e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(K,{variant:"rounded",height:120,sx:{background:"rgba(255,255,255,0.05)",borderRadius:"16px"}})},s)):I.filter(s=>z[s.id]?.online===!0).length===0?e.jsx(u,{item:!0,xs:12,children:e.jsxs(r,{sx:{p:4,background:"rgba(255,255,255,0.02)",borderRadius:"16px",border:"1px solid rgba(255,255,255,0.05)",textAlign:"center"},children:[e.jsx(P,{sx:{fontSize:48,color:"rgba(255,255,255,0.2)",mb:2}}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"1rem"},children:"No machines online"})]})}):I.filter(s=>z[s.id]?.online===!0).map((s,j)=>{const i=z[s.id],y=parseFloat(i?.cpu_usage?.replace("%","")||i?.load_avg?.split(" ")[0]||"0"),l=parseFloat(i?.memory_usage?.replace("%","")||"0"),g=parseFloat(i?.disk_usage?.replace("%","")||"0");return e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(N,{onClick:()=>n(`/machines/${s.id}`),sx:{background:"linear-gradient(145deg, rgba(34, 197, 94, 0.03) 0%, rgba(255,255,255,0.01) 100%)",border:"1px solid rgba(34, 197, 94, 0.15)",borderRadius:"16px",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",height:"100%",position:"relative",overflow:"hidden",animation:`fadeInUp 0.4s ease ${j*.05}s both`,"@keyframes fadeInUp":{from:{opacity:0,transform:"translateY(10px)"},to:{opacity:1,transform:"translateY(0)"}},"&::before":{content:'""',position:"absolute",top:0,left:0,width:"4px",height:"100%",background:"linear-gradient(180deg, #22c55e 0%, #16a34a 100%)"},"&:hover":{transform:"translateY(-4px) scale(1.01)",background:"linear-gradient(145deg, rgba(34, 197, 94, 0.08) 0%, rgba(255,255,255,0.03) 100%)",borderColor:"rgba(34, 197, 94, 0.4)",boxShadow:"0 12px 40px rgba(34, 197, 94, 0.15)"}},children:e.jsxs(U,{sx:{p:2.5,pl:3,"&:last-child":{pb:2.5}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2},children:[e.jsxs(r,{sx:{width:36,height:36,borderRadius:"10px",background:"rgba(34, 197, 94, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e.jsx(P,{sx:{color:"#22c55e",fontSize:20}}),s.has_agent&&e.jsx(r,{sx:{position:"absolute",top:-2,right:-2,width:10,height:10,borderRadius:"50%",background:"#8b5cf6",border:"2px solid #0f0f0f",animation:"pulse 2s infinite","@keyframes pulse":{"0%, 100%":{boxShadow:"0 0 0 0 rgba(139, 92, 246, 0.4)"},"50%":{boxShadow:"0 0 0 4px rgba(139, 92, 246, 0)"}}}})]}),e.jsxs(r,{sx:{flex:1,minWidth:0},children:[e.jsx(o,{sx:{color:"#fafafa",fontSize:"1rem",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name}),s.has_agent&&e.jsx(o,{sx:{color:"#8b5cf6",fontSize:"0.7rem",fontWeight:500},children:"Live Agent"})]})]}),i&&e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[e.jsx(o,{sx:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)"},children:"CPU"}),e.jsx(o,{sx:{fontSize:"0.8rem",color:y>80?t.error:y>60?t.warning:t.secondary,fontFamily:"monospace",fontWeight:600},children:i.cpu_usage||i.load_avg?.split(" ")[0]||"-"})]}),e.jsx(A,{variant:"determinate",value:Math.min(y,100),sx:{height:3,borderRadius:2,background:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{background:y>80?t.error:y>60?t.warning:t.secondary}}})]}),e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[e.jsx(o,{sx:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)"},children:"RAM"}),e.jsx(o,{sx:{fontSize:"0.8rem",color:l>85?t.error:l>70?t.warning:t.primary,fontFamily:"monospace",fontWeight:600},children:i.memory_usage||"-"})]}),e.jsx(A,{variant:"determinate",value:Math.min(l,100),sx:{height:3,borderRadius:2,background:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{background:l>85?t.error:l>70?t.warning:t.primary}}})]}),e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[e.jsx(o,{sx:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)"},children:"Disk"}),e.jsx(o,{sx:{fontSize:"0.8rem",color:g>90?t.error:g>75?t.warning:t.tertiary,fontFamily:"monospace",fontWeight:600},children:i.disk_usage||"-"})]}),e.jsx(A,{variant:"determinate",value:Math.min(g,100),sx:{height:3,borderRadius:2,background:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{background:g>90?t.error:g>75?t.warning:t.tertiary}}})]})]})]})})},s.id)})})]}),e.jsxs(r,{sx:{mb:4},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"12px",background:"linear-gradient(135deg, rgba(249, 115, 22, 0.2) 0%, rgba(249, 115, 22, 0.1) 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(249, 115, 22, 0.2)"},children:e.jsx(Le,{sx:{color:"#f97316",fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"#fafafa",fontWeight:600,fontSize:"1.15rem"},children:"Quick Actions"}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.8rem"},children:"Common tasks at your fingertips"})]})]}),e.jsxs(u,{container:!0,spacing:2,children:[S&&e.jsx(u,{item:!0,xs:6,sm:4,md:2.4,children:e.jsx(F,{icon:Re,label:"Run Script",description:"Execute scripts",color:t.primary,onClick:()=>n("/scripts")})}),S&&e.jsx(u,{item:!0,xs:6,sm:4,md:2.4,children:e.jsx(F,{icon:$e,label:"Run Command",description:"Ad-hoc commands",color:t.secondary,onClick:()=>n("/run-command")})}),C&&e.jsx(u,{item:!0,xs:6,sm:4,md:2.4,children:e.jsx(F,{icon:_e,label:"Add Machine",description:"New server",color:t.tertiary,onClick:()=>n("/machines")})}),S&&e.jsx(u,{item:!0,xs:6,sm:4,md:2.4,children:e.jsx(F,{icon:E,label:"Schedule Job",description:"Automation",color:t.warning,onClick:()=>n("/settings")})}),e.jsx(u,{item:!0,xs:6,sm:4,md:2.4,children:e.jsx(F,{icon:G,label:"View History",description:"Past runs",color:t.info,onClick:()=>n("/history")})}),!c&&e.jsx(u,{item:!0,xs:6,sm:4,md:2.4,children:e.jsx(F,{icon:Me,label:"Network",description:"Diagnostics",color:"#ec4899",onClick:()=>n("/network-tools")})})]})]}),Object.keys(z).length>0&&e.jsxs(r,{sx:{mb:4},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"12px",background:"linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(139, 92, 246, 0.1) 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(139, 92, 246, 0.2)"},children:e.jsx(Fe,{sx:{color:"#8b5cf6",fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"#fafafa",fontWeight:600,fontSize:"1.15rem"},children:"Fleet Health"}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.8rem"},children:"Aggregate resource utilization"})]})]}),e.jsx(u,{container:!0,spacing:2,children:(()=>{const s=Object.values(z).filter(m=>m.online),j=s.length>0?Math.round(s.reduce((m,R)=>{const M=parseFloat(R.cpu_usage?.replace("%","")||R.load_avg?.split(" ")[0]||"0");return m+M},0)/s.length):0,i=s.length>0?Math.round(s.reduce((m,R)=>{const M=parseFloat(R.memory_usage?.replace("%","")||"0");return m+M},0)/s.length):0,y=s.length>0?Math.round(s.reduce((m,R)=>{const M=parseFloat(R.disk_usage?.replace("%","")||"0");return m+M},0)/s.length):0,l=j>80?t.error:j>60?t.warning:t.secondary,g=i>85?t.error:i>70?t.warning:t.primary,d=y>90?t.error:y>75?t.warning:t.tertiary;return e.jsxs(e.Fragment,{children:[e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{background:`linear-gradient(135deg, ${l}08 0%, rgba(255,255,255,0.01) 100%)`,border:`1px solid ${l}20`,borderRadius:"16px",p:3,position:"relative",overflow:"hidden",transition:"all 0.3s ease","&:hover":{borderColor:`${l}40`,transform:"translateY(-2px)"},"&::before":{content:'""',position:"absolute",top:0,left:0,width:"4px",height:"100%",background:l}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"10px",background:`${l}20`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(xe,{sx:{color:l,fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"CPU Usage"}),e.jsxs(o,{sx:{color:"#fafafa",fontSize:"0.85rem",fontWeight:500},children:[s.length," machines"]})]})]}),e.jsxs(o,{sx:{color:l,fontSize:"2rem",fontWeight:700,fontFamily:"monospace"},children:[j,"%"]})]}),e.jsx(A,{variant:"determinate",value:j,sx:{height:6,borderRadius:3,background:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{background:`linear-gradient(90deg, ${l}, ${l}cc)`,borderRadius:3}}}),W.cpu.length>1&&e.jsx(r,{sx:{mt:2,opacity:.8},children:e.jsx(Q,{data:W.cpu,color:l,height:24})})]})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{background:`linear-gradient(135deg, ${g}08 0%, rgba(255,255,255,0.01) 100%)`,border:`1px solid ${g}20`,borderRadius:"16px",p:3,position:"relative",overflow:"hidden",transition:"all 0.3s ease","&:hover":{borderColor:`${g}40`,transform:"translateY(-2px)"},"&::before":{content:'""',position:"absolute",top:0,left:0,width:"4px",height:"100%",background:g}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"10px",background:`${g}20`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(de,{sx:{color:g,fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Memory Usage"}),e.jsxs(o,{sx:{color:"#fafafa",fontSize:"0.85rem",fontWeight:500},children:[s.length," machines"]})]})]}),e.jsxs(o,{sx:{color:g,fontSize:"2rem",fontWeight:700,fontFamily:"monospace"},children:[i,"%"]})]}),e.jsx(A,{variant:"determinate",value:i,sx:{height:6,borderRadius:3,background:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{background:`linear-gradient(90deg, ${g}, ${g}cc)`,borderRadius:3}}}),W.memory.length>1&&e.jsx(r,{sx:{mt:2,opacity:.8},children:e.jsx(Q,{data:W.memory,color:g,height:24})})]})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{background:`linear-gradient(135deg, ${d}08 0%, rgba(255,255,255,0.01) 100%)`,border:`1px solid ${d}20`,borderRadius:"16px",p:3,position:"relative",overflow:"hidden",transition:"all 0.3s ease","&:hover":{borderColor:`${d}40`,transform:"translateY(-2px)"},"&::before":{content:'""',position:"absolute",top:0,left:0,width:"4px",height:"100%",background:d}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"10px",background:`${d}20`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ce,{sx:{color:d,fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Disk Usage"}),e.jsxs(o,{sx:{color:"#fafafa",fontSize:"0.85rem",fontWeight:500},children:[s.length," machines"]})]})]}),e.jsxs(o,{sx:{color:d,fontSize:"2rem",fontWeight:700,fontFamily:"monospace"},children:[y,"%"]})]}),e.jsx(A,{variant:"determinate",value:y,sx:{height:6,borderRadius:3,background:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{background:`linear-gradient(90deg, ${d}, ${d}cc)`,borderRadius:3}}}),W.disk.length>1&&e.jsx(r,{sx:{mt:2,opacity:.8},children:e.jsx(Q,{data:W.disk,color:d,height:24})})]})})]})})()})]}),e.jsxs(r,{sx:{mb:4},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2.5},children:[e.jsx(r,{sx:{width:40,height:40,borderRadius:"12px",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(59, 130, 246, 0.1) 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(59, 130, 246, 0.2)"},children:e.jsx(Ee,{sx:{color:"#3b82f6",fontSize:22}})}),e.jsxs(r,{children:[e.jsx(o,{sx:{color:"#fafafa",fontWeight:600,fontSize:"1.15rem"},children:"System Overview"}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.8rem"},children:"Key metrics at a glance"})]})]}),e.jsxs(u,{container:!0,spacing:2.5,children:[e.jsx(u,{item:!0,xs:6,sm:6,md:3,children:e.jsx(T,{icon:P,title:"Machines",value:a?"-":`${w.machines.online}/${w.machines.total}`,subtitle:`${w.machines.online} online`,color:t.primary,glowColor:t.secondary,onClick:()=>n("/machines")})}),e.jsx(u,{item:!0,xs:6,sm:6,md:3,children:e.jsx(T,{icon:We,title:"Scripts",value:a?"-":w.scripts.total+w.scripts.custom,subtitle:`${w.scripts.custom} custom scripts`,color:t.secondary,glowColor:t.primary,onClick:()=>n("/scripts")})}),e.jsx(u,{item:!0,xs:6,sm:6,md:3,children:e.jsx(T,{icon:E,title:"Scheduled",value:a?"-":w.jobs.enabled,subtitle:`${w.jobs.total} total jobs`,color:t.warning,glowColor:t.warningLight,onClick:()=>n("/settings")})}),e.jsx(u,{item:!0,xs:6,sm:6,md:3,children:e.jsx(T,{icon:De,title:"Success Rate",value:a?"-":`${O}%`,subtitle:`${w.executions.today} runs today`,color:O>=90?t.secondary:O>=70?t.warning:t.error,glowColor:O>=90?t.secondaryLight:t.warningLight,onClick:()=>n("/history")})})]})]}),e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(N,{sx:{background:"linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"16px",height:"100%",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:"linear-gradient(90deg, #f97316, #22c55e)"}},children:e.jsxs(U,{sx:{p:0,height:"100%"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2.5,pb:1.5},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(r,{sx:{width:36,height:36,borderRadius:"10px",background:"rgba(249, 115, 22, 0.15)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(G,{sx:{color:"#f97316",fontSize:20}})}),e.jsx(o,{sx:{color:"#fafafa",fontWeight:600,fontSize:"1.1rem"},children:"Recent Activity"})]}),e.jsx(L,{size:"small",onClick:()=>n("/history"),endIcon:e.jsx(X,{}),sx:{color:"#f97316",textTransform:"none",fontSize:"0.85rem","&:hover":{background:"rgba(249, 115, 22, 0.1)"}},children:"View All"})]}),e.jsx(r,{sx:{maxHeight:350,overflowY:"auto","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{background:"rgba(255,255,255,0.15)",borderRadius:"3px"}},children:a?e.jsx(r,{sx:{p:2.5,display:"flex",flexDirection:"column",gap:1.5},children:[1,2,3,4,5].map(s=>e.jsx(K,{variant:"rounded",height:60,sx:{background:"rgba(255,255,255,0.05)"}},s))}):q.length===0?e.jsxs(r,{sx:{textAlign:"center",py:6},children:[e.jsx(G,{sx:{fontSize:56,color:"rgba(255,255,255,0.15)",mb:2}}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"1rem"},children:"No recent activity"})]}):e.jsx(r,{sx:{px:1.5},children:q.map(s=>e.jsx(Te,{execution:s,onClick:()=>n("/history")},s.id))})})]})})}),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(N,{sx:{background:"linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"16px",height:"100%",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:"linear-gradient(90deg, #eab308, #8b5cf6)"}},children:e.jsxs(U,{sx:{p:0,height:"100%"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2.5,pb:1.5},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(r,{sx:{width:36,height:36,borderRadius:"10px",background:"rgba(234, 179, 8, 0.15)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(E,{sx:{color:"#eab308",fontSize:20}})}),e.jsx(o,{sx:{color:"#fafafa",fontWeight:600,fontSize:"1.1rem"},children:"Scheduled Jobs"})]}),e.jsx(L,{size:"small",onClick:()=>n("/settings"),endIcon:e.jsx(X,{}),sx:{color:"#eab308",textTransform:"none",fontSize:"0.85rem","&:hover":{background:"rgba(234, 179, 8, 0.1)"}},children:"Manage"})]}),e.jsx(r,{sx:{maxHeight:350,overflowY:"auto","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{background:"rgba(255,255,255,0.15)",borderRadius:"3px"}},children:a?e.jsx(r,{sx:{p:2.5,display:"flex",flexDirection:"column",gap:1.5},children:[1,2,3].map(s=>e.jsx(K,{variant:"rounded",height:70,sx:{background:"rgba(255,255,255,0.05)"}},s))}):ee.length===0?e.jsxs(r,{sx:{textAlign:"center",py:6},children:[e.jsx(E,{sx:{fontSize:56,color:"rgba(255,255,255,0.15)",mb:2}}),e.jsx(o,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"1rem"},children:"No scheduled jobs"}),e.jsx(L,{size:"small",onClick:()=>n("/settings"),sx:{color:"#f97316",mt:2,textTransform:"none",fontSize:"0.85rem"},children:"Create one"})]}):e.jsx(r,{sx:{p:2.5,pt:1.5,display:"flex",flexDirection:"column",gap:1.5},children:ee.map(s=>e.jsx(Ne,{job:s},s.id))})})]})})})]})]})};export{lr as default};

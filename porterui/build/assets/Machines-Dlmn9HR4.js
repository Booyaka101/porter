import{c as F,j as e,u as lr,a as cr,r as d,B as a,s as dr,T as l,k as T,I as O,S as hr,l as b,m,R as xr,M as gr,n as be,L as je,o as ye,b as u,A as ke,P as fr,h as Se,d as Ce,F as ur,p as ve,q as pr,D as Y,t as mr,v as we,K as ze,w as Ie,x as Me,g as Ae,y as U,z as br,E as jr}from"./index-BShrJcTY.js";import{D as Te}from"./Delete-B-bj0F0y.js";import{W as ie}from"./Wifi-DpoXjk5d.js";import{D as yr}from"./Dns-BO8XLD19.js";import{C as kr}from"./Close-CYSn34Lw.js";import{C as Re}from"./CheckCircle-Dkkt7TPz.js";import{E as Sr}from"./Edit-d6qC9kq-.js";import{S as Cr}from"./Star-Rwi2pxCS.js";import{S as vr}from"./Storage-D1ZbLE_m.js";import{W as wr}from"./Warning-BYGbWMVj.js";import{R as zr,S as N}from"./Skeleton-DqN6JAfI.js";import{D as Fe}from"./Download-Bn-WwKFz.js";import{C as R}from"./Chip-CABxJAAn.js";import{G as Q}from"./Grid-xf7K1Fu7.js";import{C as Ir}from"./Checkbox-CYcT0eQh.js";import{S as Mr}from"./Snackbar-DR__M1Ht.js";import{D as We}from"./DialogActions-CIAGApUj.js";import"./SwitchBase-BPzvGv3M.js";const le=F(e.jsx("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"})),Ar=F(e.jsx("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"})),Tr=F([e.jsx("path",{d:"m12 2-5.5 9h11z"},"0"),e.jsx("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),e.jsx("path",{d:"M3 13.5h8v8H3z"},"2")]),Rr=F(e.jsx("path",{d:"M3 5h2V3c-1.1 0-2 .9-2 2m0 8h2v-2H3zm4 8h2v-2H7zM3 9h2V7H3zm10-6h-2v2h2zm6 0v2h2c0-1.1-.9-2-2-2M5 21v-2H3c0 1.1.9 2 2 2m-2-4h2v-2H3zM9 3H7v2h2zm2 18h2v-2h-2zm8-8h2v-2h-2zm0 8c1.1 0 2-.9 2-2h-2zm0-12h2V7h-2zm0 8h2v-2h-2zm-4 4h2v-2h-2zm0-16h2V3h-2zM7 17h10V7H7zm2-8h6v6H9z"})),Oe=F(e.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"})),Fr=F(e.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),Wr=F(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"})),Or=d.memo(()=>e.jsxs(a,{sx:{background:Ae.background.glass,borderRadius:"20px",border:`1px solid ${Ae.border.light}`,p:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(N,{variant:"circular",width:56,height:56,sx:U.base}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(N,{variant:"text",width:"60%",sx:U.base}),e.jsx(N,{variant:"text",width:"40%",sx:U.light})]}),e.jsx(N,{variant:"rounded",width:80,height:28,sx:U.base})]}),e.jsx(N,{variant:"rounded",width:"100%",height:40,sx:U.light})]})),Dr=["Production","Development","Staging","Testing","Uncategorized"],Er=C=>{const q=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ce=/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return q.test(C)||ce.test(C)},rs=()=>{const C=lr(),{canWrite:q,canExecute:ce,canAccessTerminal:De,canAccessFiles:Ee,canRunCommands:Pe}=cr(),_=q("machines"),de=De(),$e=Ee(),he=Pe(),[x,B]=d.useState([]),[D,X]=d.useState(!1),[I,ee]=d.useState(!1),[n,j]=d.useState({id:"",name:"",ip:"",username:"",password:"",category:"",notes:"",tags:[]}),[re,E]=d.useState({}),[w,xe]=d.useState("all"),[f,M]=d.useState(new Set),[J,W]=d.useState(null),[p,se]=d.useState({open:!1,message:"",severity:"success"}),[ae,P]=d.useState(""),[Le,ge]=d.useState(!0),[K,He]=d.useState(""),[y,te]=d.useState({}),[k,V]=d.useState({open:!1,data:""}),[Ue,oe]=d.useState(!1),[fe,G]=d.useState(null),[A,Ne]=d.useState(()=>{try{return JSON.parse(localStorage.getItem("favoriteMachines")||"[]")}catch{return[]}}),ue=d.useRef(null),z=async(r=!1)=>{r&&ge(!0);try{const t=await(await fetch("/api/machines")).json()||[];let o={};try{o=await(await fetch("/api/health/cached")).json()||{}}catch(c){console.warn("Failed to load health data:",c)}const i=t.map(c=>{const h=o[c.id];return h?{...c,status:h.online?"online":"offline"}:{...c,status:c.status||"unknown"}}).sort((c,h)=>{const v=A.includes(c.id)?0:1,L=A.includes(h.id)?0:1;if(v!==L)return v-L;const H={online:0,unknown:1,offline:2},Z=H[c.status]??1,me=H[h.status]??1;return Z!==me?Z-me:c.name.localeCompare(h.name)});B(i),te(o)}catch(s){console.error("Failed to load machines:",s)}finally{ge(!1)}},_e=async()=>{try{const s=await(await fetch("/api/health/cached")).json()||{};te(s),B(t=>t.map(o=>{const i=s[o.id];return i?{...o,status:i.online?"online":"offline"}:o}).sort((o,i)=>{const c={online:0,unknown:1,offline:2},h=c[o.status]??1,v=c[i.status]??1;return h!==v?h-v:o.name.localeCompare(i.name)}))}catch(r){console.error("Failed to load health:",r)}},Be=async()=>{g("Checking machine health...","info");try{const s=await(await fetch("/api/health")).json()||{};te(s),B(t=>t.map(o=>{const c=s[o.id]?.online===!0;return{...o,status:c?"online":"offline"}}).sort((o,i)=>o.status==="online"&&i.status!=="online"?-1:o.status!=="online"&&i.status==="online"?1:o.name.localeCompare(i.name))),g("Health check complete")}catch{g("Health check failed","error")}},g=(r,s="success")=>{se({open:!0,message:r,severity:s})},Je=()=>{const r=["Name","IP","Username","Status","Tags","Category"],s=S.map(h=>[h.name,h.ip,h.username,h.status,(h.tags||[]).join("; "),h.category||""]),t=[r,...s].map(h=>h.map(v=>`"${String(v||"").replace(/"/g,'""')}"`).join(",")).join(`
`),o=new Blob([t],{type:"text/csv"}),i=URL.createObjectURL(o),c=document.createElement("a");c.href=i,c.download=`machines-${new Date().toISOString().split("T")[0]}.csv`,c.click(),URL.revokeObjectURL(i),G(null),g("Exported to CSV")},Ke=()=>{const r=S.map(i=>({name:i.name,ip:i.ip,username:i.username,status:i.status,tags:i.tags,category:i.category,health:y[i.id]})),s=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),t=URL.createObjectURL(s),o=document.createElement("a");o.href=t,o.download=`machines-${new Date().toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(t),G(null),g("Exported to JSON")},pe=d.useCallback(async()=>{for(const r of x)if(r.status==="unknown")try{await fetch(`/api/machines/test?id=${r.id}`,{method:"POST"})}catch{console.error("Failed to test machine:",r.id)}},[x]);d.useEffect(()=>{z(!0);const r=setInterval(()=>z(!1),3e4),s=setInterval(_e,5e3);return()=>{clearInterval(r),clearInterval(s)}},[]),d.useEffect(()=>{x.length>0&&x.filter(s=>s.status==="unknown").length>0&&pe()},[x.length,pe]);const S=d.useMemo(()=>{const r=K.toLowerCase();return x.filter(s=>{const t=w==="all"||(s.category||"Uncategorized")===w,o=!K||s.name?.toLowerCase().includes(r)||s.ip?.toLowerCase().includes(r)||s.username?.toLowerCase().includes(r);return t&&o}).sort((s,t)=>s.name.localeCompare(t.name))},[x,w,K]);d.useEffect(()=>{const r=s=>{(s.ctrlKey||s.metaKey)&&s.key==="n"&&!D&&(s.preventDefault(),ne()),s.key==="Escape"&&D&&$(),(s.ctrlKey||s.metaKey)&&s.key==="a"&&!D&&document.activeElement.tagName!=="INPUT"&&(s.preventDefault(),M(new Set(S.map(t=>t.id))))};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[D,S]);const Ve=async()=>{if(n.ip&&!Er(n.ip)){P("Invalid IP address or hostname");return}P("");const r=x.find(s=>s.ip===n.ip&&s.id!==n.id);if(r){g(`Machine with IP ${n.ip} already exists (${r.name})`,"warning");return}if(!(!n.name||!n.ip||!n.username||!I&&!n.password))try{await fetch("/api/machines",{method:I?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,category:n.category||"Uncategorized"})}),$(),z(),g(I?"Machine updated successfully":"Machine added successfully")}catch(s){console.error("Failed to save machine:",s),g("Failed to save machine","error")}},Ge=r=>{j({id:r.id,name:r.name,ip:r.ip,username:r.username,password:"",category:r.category||"Uncategorized",notes:r.notes||"",tags:r.tags||[]}),P(""),ee(!0),X(!0)},$=()=>{X(!1),ee(!1),P(""),j({id:"",name:"",ip:"",username:"",password:"",category:"",notes:"",tags:[]})},ne=()=>{j({id:"",name:"",ip:"",username:"",password:"",category:"Uncategorized",notes:"",tags:[]}),P(""),ee(!1),X(!0)},Ze=r=>{M(s=>{const t=new Set(s);return t.has(r)?t.delete(r):t.add(r),t})},Ye=()=>{f.size===S.length?M(new Set):M(new Set(S.map(r=>r.id)))};S.reduce((r,s)=>{const t=s.category||"Uncategorized";return r[t]||(r[t]=[]),r[t].push(s),r},{});const Qe=async r=>{try{await fetch(`/api/machines?id=${r}`,{method:"DELETE"}),z(),M(s=>{const t=new Set(s);return t.delete(r),t}),g("Machine deleted successfully"),W(null)}catch(s){console.error("Failed to delete machine:",s),g("Failed to delete machine","error")}},qe=async()=>{try{for(const r of f)await fetch(`/api/machines?id=${r}`,{method:"DELETE"});M(new Set),z(),g(`${f.size} machine(s) deleted successfully`),W(null)}catch(r){console.error("Failed to delete machines:",r),g("Failed to delete machines","error")}},Xe=async r=>{E(s=>({...s,[r]:!0}));try{await fetch(`/api/machines/test?id=${r}`,{method:"POST"}),setTimeout(()=>{z(),E(s=>({...s,[r]:!1}))},2e3)}catch(s){console.error("Failed to test connection:",s),E(t=>({...t,[r]:!1})),g("Failed to test connection","error")}},er=async()=>{for(const r of f){E(s=>({...s,[r]:!0}));try{await fetch(`/api/machines/test?id=${r}`,{method:"POST"})}catch{console.error("Failed to test machine:",r)}}setTimeout(()=>{z(),E({})},3e3),g(`Testing ${f.size} machine(s)...`,"info")},rr=r=>{G(r.currentTarget)},sr=r=>{const s=r.target.files?.[0];if(!s)return;const t=new FileReader;t.onload=o=>{try{const i=JSON.parse(o.target.result);Array.isArray(i)?V({open:!0,data:i}):g("Invalid format: expected array of machines","error")}catch{g("Failed to parse JSON file","error")}},t.readAsText(s),r.target.value=""},ar=async()=>{const r=k.data;let s=0;for(const t of r)if(!(!t.name||!t.ip||!t.username)&&!x.find(o=>o.ip===t.ip))try{await fetch("/api/machines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.name,ip:t.ip,username:t.username,password:t.password||"",category:t.category||"Uncategorized"})}),s++}catch{console.error("Failed to import machine:",t.name)}V({open:!1,data:""}),z(),g(`Imported ${s} machine(s)`)},tr=r=>{switch(r){case"online":return{color:"#22c55e",bg:"rgba(34, 197, 94, 0.1)",icon:e.jsx(Re,{sx:{fontSize:16}})};case"offline":return{color:"#ff4466",bg:"rgba(255, 68, 102, 0.1)",icon:e.jsx(jr,{sx:{fontSize:16}})};default:return{color:"#ffaa00",bg:"rgba(255, 170, 0, 0.1)",icon:e.jsx(br,{sx:{fontSize:16}})}}},or=r=>{Ne(s=>{const t=s.includes(r)?s.filter(o=>o!==r):[...s,r];return localStorage.setItem("favoriteMachines",JSON.stringify(t)),t}),B(s=>[...s].sort((t,o)=>{const i=A.includes(r)?A.filter(Z=>Z!==r):[...A,r],c=i.includes(t.id)?0:1,h=i.includes(o.id)?0:1;if(c!==h)return c-h;const v={online:0,unknown:1,offline:2},L=v[t.status]??1,H=v[o.status]??1;return L!==H?L-H:t.name.localeCompare(o.name)}))},nr=x.filter(r=>r.status==="online").length,ir=x.filter(r=>r.status==="offline").length;return[...new Set(x.map(r=>r.category||"Uncategorized"))],e.jsxs(a,{role:"main","aria-label":"Machines page",sx:dr.pageContainer,children:[e.jsx(a,{sx:{background:"linear-gradient(135deg, rgba(249, 115, 22, 0.05) 0%, rgba(34, 197, 94, 0.03) 100%)",borderRadius:"24px",border:"1px solid rgba(255,255,255,0.06)",p:3,mb:4},children:e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:3},children:[e.jsxs(a,{children:[e.jsx(l,{sx:{fontSize:"2.2rem",fontWeight:800,background:"linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.8) 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",letterSpacing:"-0.02em",mb:.5},children:"Machines"}),e.jsx(l,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.95rem"},children:"Manage and monitor your deployment targets"}),e.jsxs(a,{sx:{display:"flex",gap:3,mt:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(a,{sx:{width:10,height:10,borderRadius:"50%",background:"#22c55e",boxShadow:"0 0 10px #22c55e"}}),e.jsxs(l,{sx:{color:"rgba(255,255,255,0.7)",fontSize:"0.85rem"},children:[e.jsx("strong",{style:{color:"#22c55e"},children:nr})," Online"]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(a,{sx:{width:10,height:10,borderRadius:"50%",background:"#ff4466"}}),e.jsxs(l,{sx:{color:"rgba(255,255,255,0.7)",fontSize:"0.85rem"},children:[e.jsx("strong",{style:{color:"#ff4466"},children:ir})," Offline"]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(vr,{sx:{fontSize:14,color:"rgba(255,255,255,0.4)"}}),e.jsxs(l,{sx:{color:"rgba(255,255,255,0.7)",fontSize:"0.85rem"},children:[e.jsx("strong",{style:{color:"#fff"},children:x.length})," Total"]})]})]})]}),e.jsxs(a,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(T,{placeholder:"Search machines...",size:"small",value:K,onChange:r=>He(r.target.value),InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(hr,{sx:{color:"rgba(255,255,255,0.3)",fontSize:20}})})},sx:{width:220,"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.2)",borderRadius:"12px","& fieldset":{borderColor:"rgba(255,255,255,0.1)"},"&:hover fieldset":{borderColor:"rgba(249, 115, 22, 0.3)"},"&.Mui-focused fieldset":{borderColor:"#f97316"}}}}),e.jsx(b,{title:"Refresh",children:e.jsx(m,{onClick:z,sx:{color:"rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.03)","&:hover":{color:"#f97316",background:"rgba(249, 115, 22, 0.1)"}},children:e.jsx(xr,{})})}),e.jsx(b,{title:"Check Health",children:e.jsx(m,{onClick:Be,sx:{color:"rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.03)","&:hover":{color:"#22c55e",background:"rgba(34, 197, 94, 0.1)"}},children:e.jsx(ie,{})})}),e.jsx(b,{title:"Export Machines",children:e.jsx(m,{onClick:rr,disabled:x.length===0,sx:{color:"rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.03)","&:hover":{color:"#ff79c6",background:"rgba(255, 121, 198, 0.1)"}},children:e.jsx(Fr,{})})}),e.jsx(b,{title:"Import Machines",children:e.jsx(m,{onClick:()=>ue.current?.click(),sx:{color:"rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.03)","&:hover":{color:"#8be9fd",background:"rgba(139, 233, 253, 0.1)"}},children:e.jsx(Oe,{})})}),e.jsx("input",{type:"file",ref:ue,accept:".json",onChange:sr,style:{display:"none"}}),e.jsxs(gr,{anchorEl:fe,open:!!fe,onClose:()=>G(null),PaperProps:{sx:{bgcolor:"rgba(17, 24, 39, 0.95)",border:"1px solid rgba(255,255,255,0.1)"}},children:[e.jsxs(be,{onClick:Je,children:[e.jsx(je,{children:e.jsx(Fe,{sx:{color:"#22c55e"}})}),e.jsx(ye,{primary:"Export as CSV",secondary:`${S.length} machines`})]}),e.jsxs(be,{onClick:Ke,children:[e.jsx(je,{children:e.jsx(Fe,{sx:{color:"#f97316"}})}),e.jsx(ye,{primary:"Export as JSON",secondary:"With health data"})]})]}),e.jsx(b,{title:"Keyboard Shortcuts (?)",children:e.jsx(m,{onClick:()=>oe(!0),sx:{color:"rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.03)","&:hover":{color:"#ffaa00",background:"rgba(255, 170, 0, 0.1)"}},children:e.jsx(Wr,{})})}),_&&e.jsx(u,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:ne,sx:{background:"linear-gradient(135deg, #f97316 0%, #22c55e 100%)",color:"#0a0a0f",fontWeight:700,px:3,py:1.2,borderRadius:"12px",textTransform:"none",fontSize:"0.95rem",boxShadow:"0 4px 20px rgba(249, 115, 22, 0.3)","&:hover":{background:"linear-gradient(135deg, #fb923c 0%, #4ade80 100%)",boxShadow:"0 6px 30px rgba(249, 115, 22, 0.5)",transform:"translateY(-2px)"},transition:"all 0.2s ease"},children:"Add Machine"})]})]})}),e.jsx(a,{sx:{minHeight:f.size>0?56:0,mb:f.size>0?3:0,transition:"all 0.2s ease"},children:f.size>0&&e.jsxs(a,{sx:{p:2,borderRadius:"12px",background:"linear-gradient(135deg, rgba(249, 115, 22, 0.1) 0%, rgba(34, 197, 94, 0.05) 100%)",border:"1px solid rgba(249, 115, 22, 0.3)",display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,background:"rgba(249, 115, 22, 0.2)",px:1.5,py:.5,borderRadius:"8px"},children:[e.jsx(Re,{sx:{fontSize:16,color:"#f97316"}}),e.jsxs(l,{sx:{color:"#f97316",fontWeight:600,fontSize:"0.9rem"},children:[f.size," machine",f.size>1?"s":""," selected"]})]}),e.jsx(a,{sx:{width:"1px",height:24,background:"rgba(255,255,255,0.1)"}}),he&&e.jsx(u,{size:"small",startIcon:e.jsx(fr,{}),onClick:()=>C(`/scripts?machines=${Array.from(f).join(",")}`),sx:{background:"linear-gradient(135deg, #f97316 0%, #00a8cc 100%)",color:"#0a0a0f",fontWeight:600,"&:hover":{background:"linear-gradient(135deg, #5ce1ff 0%, #f97316 100%)"}},variant:"contained",children:"Run Script"}),de&&e.jsx(u,{size:"small",startIcon:e.jsx(Se,{}),onClick:()=>C(`/run-command?machines=${Array.from(f).join(",")}`),sx:{background:"linear-gradient(135deg, #22c55e 0%, #00cc6a 100%)",color:"#0a0a0f",fontWeight:600,"&:hover":{background:"linear-gradient(135deg, #66ffaa 0%, #22c55e 100%)"}},variant:"contained",children:"Run Command"}),e.jsx(a,{sx:{width:"1px",height:24,background:"rgba(255,255,255,0.1)"}}),e.jsx(u,{size:"small",startIcon:e.jsx(ie,{}),onClick:er,sx:{color:"#f97316",borderColor:"rgba(249, 115, 22, 0.5)"},variant:"outlined",children:"Test All"}),_&&e.jsx(u,{size:"small",startIcon:e.jsx(Te,{}),onClick:()=>W("bulk"),sx:{color:"#ff4466",borderColor:"rgba(255, 68, 102, 0.5)"},variant:"outlined",children:"Delete"}),e.jsx(u,{size:"small",onClick:()=>M(new Set),sx:{color:"rgba(255,255,255,0.5)"},children:"Clear"})]})}),e.jsx(a,{sx:{mb:3,display:"flex",gap:1,flexWrap:"wrap",alignItems:"center",minHeight:40},children:x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Select All (Ctrl+A)",children:e.jsx(m,{size:"small",onClick:Ye,sx:{color:f.size===S.length&&S.length>0?"#f97316":"rgba(255,255,255,0.5)","&:hover":{background:"rgba(249, 115, 22, 0.1)"}},children:e.jsx(Rr,{fontSize:"small"})})}),e.jsx(R,{label:`All (${x.length})`,onClick:()=>xe("all"),sx:{background:w==="all"?"linear-gradient(135deg, #f97316 0%, #22c55e 100%)":"rgba(255,255,255,0.05)",color:w==="all"?"#0a0a0f":"rgba(255,255,255,0.7)",fontWeight:600,"&:hover":{background:w==="all"?"linear-gradient(135deg, #f97316 0%, #22c55e 100%)":"rgba(255,255,255,0.1)"}}}),[...new Set(x.map(r=>r.category||"Uncategorized"))].map(r=>e.jsx(R,{label:`${r} (${x.filter(s=>(s.category||"Uncategorized")===r).length})`,onClick:()=>xe(r),sx:{background:w===r?"linear-gradient(135deg, #f97316 0%, #22c55e 100%)":"rgba(255,255,255,0.05)",color:w===r?"#0a0a0f":"rgba(255,255,255,0.7)",fontWeight:600,"&:hover":{background:w===r?"linear-gradient(135deg, #f97316 0%, #22c55e 100%)":"rgba(255,255,255,0.1)"}}},r))]})}),e.jsx(Q,{container:!0,spacing:3,children:Le?[1,2,3,4,5,6].map(r=>e.jsx(Q,{item:!0,xs:12,sm:6,lg:4,children:e.jsx(Or,{})},r)):x.length===0?e.jsx(Q,{item:!0,xs:12,children:e.jsxs(a,{sx:{textAlign:"center",py:12,background:"rgba(255,255,255,0.02)",borderRadius:"20px",border:"1px dashed rgba(255,255,255,0.1)"},children:[e.jsx(Ce,{sx:{fontSize:80,color:"rgba(249, 115, 22, 0.3)",mb:3}}),e.jsx(l,{sx:{color:"rgba(255,255,255,0.7)",fontSize:"1.2rem",mb:1},children:"No machines configured"}),e.jsx(l,{sx:{color:"rgba(255,255,255,0.4)",mb:3},children:"Add your first machine to start deploying scripts"}),e.jsx(u,{variant:"outlined",startIcon:e.jsx(ke,{}),onClick:ne,sx:{borderColor:"rgba(249, 115, 22, 0.5)",color:"#f97316","&:hover":{borderColor:"#f97316",background:"rgba(249, 115, 22, 0.1)"}},children:"Add Your First Machine"})]})}):S.map((r,s)=>{const t=tr(r.status),o=f.has(r.id);return e.jsx(Q,{item:!0,xs:12,sm:6,lg:4,children:e.jsx(ur,{in:!0,timeout:300,children:e.jsxs(a,{sx:{background:o?"rgba(249, 115, 22, 0.08)":"rgba(255,255,255,0.03)",borderRadius:"16px",border:o?"1px solid rgba(249, 115, 22, 0.4)":"1px solid rgba(255,255,255,0.08)",overflow:"hidden",transition:"border 0.2s ease, background 0.2s ease, box-shadow 0.2s ease",minHeight:220,"&:hover":{border:"1px solid rgba(249, 115, 22, 0.3)",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)"}},children:[e.jsx(a,{sx:{height:3,background:`linear-gradient(90deg, ${t.color} 0%, transparent 100%)`}}),e.jsxs(a,{sx:{p:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Ir,{checked:o,onChange:()=>Ze(r.id),sx:{color:"rgba(255,255,255,0.3)","&.Mui-checked":{color:"#f97316"},p:0,mr:1}}),e.jsx(a,{onClick:()=>C(`/machines/${r.id}`),sx:{width:48,height:48,borderRadius:"12px",background:"rgba(249, 115, 22, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s","&:hover":{background:"rgba(249, 115, 22, 0.2)"}},children:e.jsx(Ce,{sx:{color:"#f97316",fontSize:24}})}),e.jsxs(a,{onClick:()=>C(`/machines/${r.id}`),sx:{cursor:"pointer"},children:[e.jsx(l,{sx:{fontWeight:600,fontSize:"1.1rem",color:"#fff","&:hover":{color:"#f97316"}},children:r.name}),e.jsx(l,{sx:{fontSize:"0.8rem",color:"rgba(255,255,255,0.5)",fontFamily:"monospace"},children:r.ip})]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(b,{title:A.includes(r.id)?"Remove from favorites":"Add to favorites",children:e.jsx(m,{size:"small",onClick:i=>{i.stopPropagation(),or(r.id)},sx:{p:.5},children:A.includes(r.id)?e.jsx(Cr,{sx:{fontSize:18,color:"#ffaa00"}}):e.jsx(Ar,{sx:{fontSize:18,color:"rgba(255,255,255,0.3)"}})})}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5,px:1.5,py:.5,borderRadius:"8px",background:t.bg,color:t.color},children:[t.icon,e.jsx(l,{sx:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"},children:r.status||"unknown"})]})]})]}),y[r.id]&&y[r.id].online&&e.jsxs(a,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:1,mb:2,p:1.5,background:"rgba(0,0,0,0.2)",borderRadius:"8px"},children:[y[r.id].cpu_usage&&e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{sx:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)"},children:"CPU:"}),e.jsx(l,{sx:{fontSize:"0.7rem",color:"#ffaa00",fontFamily:"monospace"},children:y[r.id].cpu_usage})]}),y[r.id].memory_usage&&e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{sx:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)"},children:"Mem:"}),e.jsx(l,{sx:{fontSize:"0.7rem",color:"#f97316",fontFamily:"monospace"},children:y[r.id].memory_usage})]}),y[r.id].disk_usage&&e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{sx:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)"},children:"Disk:"}),e.jsx(l,{sx:{fontSize:"0.7rem",color:"#22c55e",fontFamily:"monospace"},children:y[r.id].disk_usage})]}),y[r.id].response_time_ms>0?e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{sx:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)"},children:"Ping:"}),e.jsxs(l,{sx:{fontSize:"0.7rem",color:"#22c55e",fontFamily:"monospace"},children:[y[r.id].response_time_ms,"ms"]})]}):e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{sx:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)"},children:"Mode:"}),e.jsx(l,{sx:{fontSize:"0.7rem",color:"#ff00ff",fontFamily:"monospace"},children:"Agent"})]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:r.notes||r.tags?.length?1:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5,color:"rgba(255,255,255,0.4)"},children:[e.jsx(ve,{sx:{fontSize:16}}),e.jsx(l,{sx:{fontSize:"0.85rem"},children:r.username})]}),r.category&&e.jsx(R,{size:"small",label:r.category,icon:e.jsx(Tr,{sx:{fontSize:14}}),sx:{height:24,background:"rgba(249, 115, 22, 0.1)",color:"#f97316","& .MuiChip-icon":{color:"#f97316"}}})]}),r.tags?.length>0&&e.jsx(a,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:r.notes?1:3},children:r.tags.map((i,c)=>e.jsx(R,{label:i,size:"small",icon:e.jsx(le,{sx:{fontSize:"12px !important"}}),sx:{height:22,fontSize:"0.7rem",background:"rgba(255, 170, 0, 0.1)",border:"1px solid rgba(255, 170, 0, 0.3)",color:"#ffaa00","& .MuiChip-icon":{color:"#ffaa00"}}},c))}),r.notes&&e.jsx(b,{title:r.notes,children:e.jsxs(l,{sx:{fontSize:"0.75rem",color:"rgba(255,255,255,0.4)",fontStyle:"italic",mb:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:["ðŸ“ ",r.notes]})}),e.jsxs(a,{sx:{display:"flex",gap:1},children:[de&&e.jsx(b,{title:"Terminal",children:e.jsx(m,{size:"small",onClick:()=>C(`/machines/${r.id}/terminal`),sx:{color:"#22c55e",background:"rgba(34, 197, 94, 0.1)","&:hover":{background:"rgba(34, 197, 94, 0.2)"}},children:e.jsx(Se,{fontSize:"small"})})}),$e&&e.jsx(b,{title:"Files",children:e.jsx(m,{size:"small",onClick:()=>C(`/machines/${r.id}/files`),sx:{color:"#ffaa00",background:"rgba(255, 170, 0, 0.1)","&:hover":{background:"rgba(255, 170, 0, 0.2)"}},children:e.jsx(pr,{fontSize:"small"})})}),he&&e.jsx(b,{title:"Run Script",children:e.jsx(m,{size:"small",onClick:()=>C(`/scripts?machines=${r.id}`),sx:{color:"#ff79c6",background:"rgba(255, 121, 198, 0.1)","&:hover":{background:"rgba(255, 121, 198, 0.2)"}},children:e.jsx(zr,{fontSize:"small"})})}),e.jsx(u,{size:"small",startIcon:re[r.id]?null:e.jsx(ie,{}),onClick:()=>Xe(r.id),disabled:re[r.id],sx:{flex:1,color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)","&:hover":{borderColor:"#f97316",background:"rgba(249, 115, 22, 0.1)"}},variant:"outlined",children:re[r.id]?"Testing...":"Test"}),_&&e.jsx(m,{size:"small",onClick:()=>Ge(r),sx:{color:"rgba(255, 255, 255, 0.5)","&:hover":{color:"#f97316",background:"rgba(249, 115, 22, 0.1)"}},children:e.jsx(Sr,{fontSize:"small"})}),_&&e.jsx(b,{title:"Delete",children:e.jsx(m,{size:"small",onClick:()=>W(r.id),sx:{color:"rgba(255, 68, 102, 0.7)","&:hover":{color:"#ff4466",background:"rgba(255, 68, 102, 0.1)"}},children:e.jsx(Te,{fontSize:"small"})})})]})]})]})})},r.id)})}),e.jsx(Y,{open:D,onClose:$,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{background:"linear-gradient(180deg, #1a1a2e 0%, #0f0f1a 100%)",border:"1px solid rgba(249, 115, 22, 0.2)",borderRadius:"20px"}},children:e.jsxs(a,{sx:{p:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(l,{sx:{fontSize:"1.5rem",fontWeight:700,color:"#fff"},children:I?"Edit Machine":"Add New Machine"}),e.jsx(m,{onClick:$,sx:{color:"rgba(255,255,255,0.5)"},children:e.jsx(kr,{})})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[e.jsx(T,{placeholder:"Machine Name",fullWidth:!0,value:n.name,onChange:r=>j({...n,name:r.target.value}),InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(le,{sx:{color:"rgba(249, 115, 22, 0.5)"}})})},sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.3)",borderRadius:"12px"}}}),e.jsx(T,{placeholder:"IP Address",fullWidth:!0,value:n.ip,onChange:r=>j({...n,ip:r.target.value}),error:!!ae,helperText:ae,InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(yr,{sx:{color:ae?"#ff4466":"rgba(249, 115, 22, 0.5)"}})})},sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.3)",borderRadius:"12px"},"& .MuiFormHelperText-root":{color:"#ff4466"}}}),e.jsx(T,{placeholder:"Username",fullWidth:!0,value:n.username,onChange:r=>j({...n,username:r.target.value}),InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(ve,{sx:{color:"rgba(249, 115, 22, 0.5)"}})})},sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.3)",borderRadius:"12px"}}}),e.jsx(T,{placeholder:I?"Password (leave blank to keep current)":"Password",type:"password",fullWidth:!0,value:n.password,onChange:r=>j({...n,password:r.target.value}),InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(mr,{sx:{color:"rgba(249, 115, 22, 0.5)"}})})},sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.3)",borderRadius:"12px"}}}),e.jsxs(a,{children:[e.jsx(l,{sx:{fontSize:"0.85rem",color:"rgba(255,255,255,0.5)",mb:1},children:"Category"}),e.jsx(a,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:Dr.map(r=>e.jsx(R,{label:r,onClick:()=>j({...n,category:r}),sx:{background:n.category===r?"linear-gradient(135deg, #f97316 0%, #22c55e 100%)":"rgba(255,255,255,0.05)",color:n.category===r?"#0a0a0f":"rgba(255,255,255,0.7)",fontWeight:600,cursor:"pointer","&:hover":{background:n.category===r?"linear-gradient(135deg, #f97316 0%, #22c55e 100%)":"rgba(255,255,255,0.1)"}}},r))})]}),e.jsx(T,{placeholder:"Notes (optional) - e.g., purpose, configuration, important info...",fullWidth:!0,multiline:!0,rows:2,value:n.notes,onChange:r=>j({...n,notes:r.target.value}),sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.3)",borderRadius:"12px"}}}),e.jsxs(a,{children:[e.jsx(l,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.75rem",mb:1},children:"Tags (for script filtering) - Press Enter or Tab to add"}),e.jsx(T,{placeholder:"Type a tag and press Enter (e.g., build)",fullWidth:!0,onKeyDown:r=>{if(r.key==="Enter"||r.key==="Tab"){r.preventDefault();const s=r.target.value.trim();s&&!n.tags?.includes(s)&&j({...n,tags:[...n.tags||[],s]}),r.target.value=""}},InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(le,{sx:{color:"rgba(255,255,255,0.3)"}})})},sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.3)",borderRadius:"12px"}}}),n.tags?.length>0&&e.jsx(a,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:1},children:n.tags.map((r,s)=>e.jsx(R,{label:r,size:"small",onDelete:()=>j({...n,tags:n.tags.filter((t,o)=>o!==s)}),sx:{background:"rgba(249, 115, 22, 0.1)",border:"1px solid rgba(249, 115, 22, 0.3)",color:"#f97316"}},s))})]})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mt:4},children:[e.jsx(u,{fullWidth:!0,onClick:$,sx:{py:1.5,color:"rgba(255,255,255,0.7)",borderColor:"rgba(255,255,255,0.2)","&:hover":{borderColor:"rgba(255,255,255,0.4)"}},variant:"outlined",children:"Cancel"}),e.jsx(u,{fullWidth:!0,variant:"contained",onClick:Ve,disabled:!n.name||!n.ip||!n.username||!I&&!n.password,sx:{py:1.5,background:"linear-gradient(135deg, #f97316 0%, #22c55e 100%)",color:"#0a0a0f",fontWeight:600,"&:hover":{background:"linear-gradient(135deg, #fb923c 0%, #4ade80 100%)"},"&:disabled":{background:"rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.3)"}},children:I?"Save Changes":"Add Machine"})]})]})}),e.jsx(Y,{open:J!==null,onClose:()=>W(null),PaperProps:{sx:{background:"linear-gradient(180deg, #1a1a2e 0%, #0f0f1a 100%)",border:"1px solid rgba(255, 68, 102, 0.3)",borderRadius:"16px",minWidth:400}},children:e.jsxs(a,{sx:{p:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(a,{sx:{width:48,height:48,borderRadius:"12px",background:"rgba(255, 68, 102, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(wr,{sx:{color:"#ff4466",fontSize:28}})}),e.jsx(l,{sx:{fontSize:"1.3rem",fontWeight:700,color:"#fff"},children:"Confirm Delete"})]}),e.jsx(l,{sx:{color:"rgba(255,255,255,0.7)",mb:3},children:J==="bulk"?`Are you sure you want to delete ${f.size} machine(s)? This action cannot be undone.`:"Are you sure you want to delete this machine? This action cannot be undone."}),e.jsxs(a,{sx:{display:"flex",gap:2},children:[e.jsx(u,{fullWidth:!0,onClick:()=>W(null),sx:{py:1.5,color:"rgba(255,255,255,0.7)",borderColor:"rgba(255,255,255,0.2)"},variant:"outlined",children:"Cancel"}),e.jsx(u,{fullWidth:!0,onClick:()=>J==="bulk"?qe():Qe(J),sx:{py:1.5,background:"linear-gradient(135deg, #ff4466 0%, #ff6688 100%)",color:"#fff",fontWeight:600,"&:hover":{background:"linear-gradient(135deg, #ff5577 0%, #ff7799 100%)"}},children:"Delete"})]})]})}),e.jsx(Mr,{open:p.open,autoHideDuration:4e3,onClose:()=>se({...p,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(we,{onClose:()=>se({...p,open:!1}),severity:p.severity,sx:{background:p.severity==="success"?"rgba(34, 197, 94, 0.1)":p.severity==="error"?"rgba(255, 68, 102, 0.1)":p.severity==="warning"?"rgba(255, 170, 0, 0.1)":"rgba(249, 115, 22, 0.1)",border:`1px solid ${p.severity==="success"?"rgba(34, 197, 94, 0.3)":p.severity==="error"?"rgba(255, 68, 102, 0.3)":p.severity==="warning"?"rgba(255, 170, 0, 0.3)":"rgba(249, 115, 22, 0.3)"}`,color:"#fff","& .MuiAlert-icon":{color:p.severity==="success"?"#22c55e":p.severity==="error"?"#ff4466":p.severity==="warning"?"#ffaa00":"#f97316"}},children:p.message})}),e.jsxs(a,{sx:{position:"fixed",bottom:20,left:20,display:"flex",alignItems:"center",gap:1,px:2,py:1,borderRadius:"8px",background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(ze,{sx:{fontSize:16,color:"rgba(255,255,255,0.4)"}}),e.jsx(l,{sx:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)"},children:"Ctrl+N: Add â€¢ Ctrl+A: Select All â€¢ Esc: Close"})]}),e.jsxs(Y,{open:k.open,onClose:()=>V({open:!1,data:""}),maxWidth:"md",fullWidth:!0,children:[e.jsxs(Ie,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Oe,{sx:{color:"#8be9fd"}}),"Import Machines Preview"]}),e.jsxs(Me,{children:[e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:Array.isArray(k.data)?`${k.data.length} machine(s) found. Duplicates (same IP) will be skipped.`:"No machines found"}),Array.isArray(k.data)&&k.data.length>0&&e.jsx(a,{sx:{maxHeight:300,overflow:"auto",bgcolor:"#0d1117",borderRadius:1,p:2},children:k.data.map((r,s)=>e.jsxs(a,{sx:{display:"flex",gap:2,py:1,borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(l,{sx:{fontWeight:600,color:"#fff",minWidth:150},children:r.name}),e.jsx(l,{sx:{color:"#f97316",fontFamily:"monospace"},children:r.ip}),e.jsx(l,{sx:{color:"rgba(255,255,255,0.5)"},children:r.username}),e.jsx(R,{label:r.category||"Uncategorized",size:"small",sx:{ml:"auto"}})]},s))}),e.jsx(we,{severity:"warning",sx:{mt:2},children:"Note: Passwords are not exported for security. You'll need to update passwords after import."})]}),e.jsxs(We,{children:[e.jsx(u,{onClick:()=>V({open:!1,data:""}),children:"Cancel"}),e.jsxs(u,{variant:"contained",onClick:ar,disabled:!Array.isArray(k.data)||k.data.length===0,children:["Import ",Array.isArray(k.data)?k.data.length:0," Machine(s)"]})]})]}),e.jsxs(Y,{open:Ue,onClose:()=>oe(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Ie,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ze,{sx:{color:"#ffaa00"}}),"Keyboard Shortcuts"]}),e.jsx(Me,{children:e.jsx(a,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[{keys:"Ctrl + N",desc:"Add new machine"},{keys:"Ctrl + A",desc:"Select all machines"},{keys:"Ctrl + 1",desc:"Go to Dashboard"},{keys:"Ctrl + 2",desc:"Go to Machines"},{keys:"Ctrl + 3",desc:"Go to Scripts"},{keys:"Ctrl + 4",desc:"Go to History"},{keys:"Escape",desc:"Close dialogs"},{keys:"?",desc:"Show this help"}].map(({keys:r,desc:s})=>e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(a,{sx:{px:1.5,py:.5,borderRadius:1,bgcolor:"rgba(255,255,255,0.1)",fontFamily:"monospace",fontSize:"0.85rem",minWidth:100,textAlign:"center"},children:r}),e.jsx(l,{color:"text.secondary",children:s})]},r))})}),e.jsx(We,{children:e.jsx(u,{onClick:()=>oe(!1),children:"Close"})})]})]})};export{rs as default};

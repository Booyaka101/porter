import{c as Z,j as e,u as q,r as c,B as n,a1 as D,T as l,g as i,l as W,m as V,R as J,X as A,C as E,G as H,d as O,Z as T,b as L,a4 as K,a5 as Q,a2 as Y,n as P}from"./index-BR8HzIu-.js";import{C as _}from"./CheckCircle-CQPaGP6K.js";import{M as ee}from"./Memory-CnTy6_-k.js";import{S as se}from"./Storage-CtphLD8r.js";import{S as te}from"./Speed-B5FvcT1a.js";import{A as ae}from"./AccessTime-FnwC1SCA.js";const ne=Z(e.jsx("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99zM21 9l-3.99-4v3H10v2h7.01v3z"})),F=c.memo(({value:b,onChange:S,label:y,otherValue:t,machines:g})=>e.jsxs(K,{fullWidth:!0,size:"small",children:[e.jsx(Q,{children:y}),e.jsxs(Y,{value:b,onChange:s=>S(s.target.value),label:y,MenuProps:{PaperProps:{sx:{bgcolor:"rgba(20, 20, 20, 0.98)",border:"1px solid rgba(255,255,255,0.1)",maxHeight:300}}},sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255,255,255,0.1)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(249, 115, 22, 0.4)"}},children:[e.jsx(P,{value:"",children:"Select a machine"}),g.map(s=>e.jsxs(P,{value:s.id,disabled:s.id===t,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{sx:{fontSize:16,color:s.status==="online"?"#22c55e":"#ff3333"}}),s.name," (",s.ip,")"]},s.id))]})]})),de=()=>{const b=q(),[S,y]=c.useState([]),[t,g]=c.useState(""),[s,C]=c.useState(""),[r,R]=c.useState(null),[o,w]=c.useState(null),[U,$]=c.useState(!1),[G,B]=c.useState(!1),I=c.useRef(""),k=c.useRef("");c.useEffect(()=>{let a=!0;return fetch("/api/machines").then(d=>d.json()).then(d=>{a&&y(d||[])}).catch(()=>{}),()=>{a=!1}},[]),c.useEffect(()=>{if(t===I.current)return;if(I.current=t,!t){R(null);return}let a=!0;return $(!0),(async()=>{try{const f=await(await fetch(`/api/machines/${t}`)).json(),u=await(await fetch(`/api/machines/${t}/health`)).json();let m={running:0,total:0};try{const j=await(await fetch(`/api/machines/${t}/services`)).json();m.total=j.services?.length||0,m.running=j.services?.filter(v=>v.status==="active"||v.subState==="running").length||0}catch{}let p=null;try{p=await(await fetch(`/api/machines/${t}/docker/info`)).json()}catch{}a&&R({machine:f,health:u,servicesCount:m,dockerInfo:p})}catch(x){console.error("Failed to load machine 1 data:",x),a&&R({error:x.message})}finally{a&&$(!1)}})(),()=>{a=!1}},[t]),c.useEffect(()=>{if(s===k.current)return;if(k.current=s,!s){w(null);return}let a=!0;return B(!0),(async()=>{try{const f=await(await fetch(`/api/machines/${s}`)).json(),u=await(await fetch(`/api/machines/${s}/health`)).json();let m={running:0,total:0};try{const j=await(await fetch(`/api/machines/${s}/services`)).json();m.total=j.services?.length||0,m.running=j.services?.filter(v=>v.status==="active"||v.subState==="running").length||0}catch{}let p=null;try{p=await(await fetch(`/api/machines/${s}/docker/info`)).json()}catch{}a&&w({machine:f,health:u,servicesCount:m,dockerInfo:p})}catch(x){console.error("Failed to load machine 2 data:",x),a&&w({error:x.message})}finally{a&&B(!1)}})(),()=>{a=!1}},[s]);const N=()=>{I.current="",k.current="";const a=t;g(s),C(a)},X=c.useCallback(()=>{I.current="",k.current="";const a=t,d=s;g(""),C(""),setTimeout(()=>{g(a),C(d)},0)},[t,s]),h=({label:a,value1:d,value2:x,icon:f,highlight:M})=>{const u=d!==x&&d&&x;return e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 200px 1fr",gap:2,py:1.5,px:2,borderRadius:1,bgcolor:M?"rgba(249, 115, 22, 0.05)":"transparent","&:hover":{bgcolor:"rgba(255,255,255,0.02)"}},children:[e.jsx(n,{sx:{textAlign:"right",color:u?"#f97316":i.text.primary,fontWeight:u?600:400,fontFamily:"monospace",fontSize:"0.9rem"},children:d||"-"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1,color:i.text.muted},children:[f&&e.jsx(f,{sx:{fontSize:16}}),e.jsx(l,{variant:"caption",sx:{fontWeight:500},children:a})]}),e.jsx(n,{sx:{textAlign:"left",color:u?"#22c55e":i.text.primary,fontWeight:u?600:400,fontFamily:"monospace",fontSize:"0.9rem"},children:x||"-"})]})};return e.jsxs(n,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[e.jsx(D,{sx:{fontSize:32,color:"#f97316"}}),e.jsxs(n,{children:[e.jsx(l,{variant:"h5",sx:{fontWeight:700,color:i.text.primary},children:"Machine Comparison"}),e.jsx(l,{variant:"body2",sx:{color:i.text.muted},children:"Compare configurations and status of two machines side-by-side"})]}),e.jsx(n,{sx:{flex:1}}),e.jsx(W,{title:"Refresh Both",children:e.jsx(V,{onClick:X,disabled:!t&&!s,children:e.jsx(J,{})})})]}),e.jsx(A,{sx:{p:3,mb:3,bgcolor:"rgba(255,255,255,0.02)"},children:e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr auto 1fr",gap:2,alignItems:"center"},children:[e.jsx(F,{value:t,onChange:g,label:"Machine 1",otherValue:s,machines:S}),e.jsx(W,{title:"Swap Machines",children:e.jsx(V,{onClick:N,disabled:!t||!s,children:e.jsx(ne,{sx:{color:"#f97316"}})})}),e.jsx(F,{value:s,onChange:C,label:"Machine 2",otherValue:t,machines:S})]})}),(t||s)&&e.jsxs(A,{sx:{bgcolor:"rgba(255,255,255,0.02)",overflow:"hidden"},children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 200px 1fr",gap:2,p:2,bgcolor:"rgba(249, 115, 22, 0.1)",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(n,{sx:{textAlign:"right"},children:U?e.jsx(E,{size:20}):r?.machine?e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1},children:[e.jsx(l,{sx:{fontWeight:600,color:"#f97316"},children:r.machine.name}),r.machine.status==="online"?e.jsx(_,{sx:{fontSize:16,color:"#22c55e"}}):e.jsx(H,{sx:{fontSize:16,color:"#ff3333"}})]}):e.jsx(l,{sx:{color:i.text.muted},children:"Select Machine 1"})}),e.jsx(n,{sx:{textAlign:"center"},children:e.jsx(D,{sx:{color:i.text.muted}})}),e.jsx(n,{sx:{textAlign:"left"},children:G?e.jsx(E,{size:20}):o?.machine?e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[o.machine.status==="online"?e.jsx(_,{sx:{fontSize:16,color:"#22c55e"}}):e.jsx(H,{sx:{fontSize:16,color:"#ff3333"}}),e.jsx(l,{sx:{fontWeight:600,color:"#22c55e"},children:o.machine.name})]}):e.jsx(l,{sx:{color:i.text.muted},children:"Select Machine 2"})})]}),e.jsxs(n,{sx:{p:1},children:[e.jsx(l,{variant:"overline",sx:{color:i.text.muted,px:2,display:"block",mt:1},children:"Basic Information"}),e.jsx(h,{label:"IP Address",value1:r?.machine?.ip,value2:o?.machine?.ip,icon:O}),e.jsx(h,{label:"Username",value1:r?.machine?.username,value2:o?.machine?.username}),e.jsx(h,{label:"Status",value1:r?.machine?.status,value2:o?.machine?.status}),e.jsx(T,{sx:{my:2,borderColor:"rgba(255,255,255,0.05)"}}),e.jsx(l,{variant:"overline",sx:{color:i.text.muted,px:2,display:"block"},children:"System Health"}),e.jsx(h,{label:"Uptime",value1:r?.health?.uptime,value2:o?.health?.uptime,icon:ae,highlight:!0}),e.jsx(h,{label:"Load Average",value1:r?.health?.load_avg,value2:o?.health?.load_avg,icon:te}),e.jsx(h,{label:"Memory Usage",value1:r?.health?.memory_usage,value2:o?.health?.memory_usage,icon:ee}),e.jsx(h,{label:"Disk Usage",value1:r?.health?.disk_usage,value2:o?.health?.disk_usage,icon:se}),e.jsx(T,{sx:{my:2,borderColor:"rgba(255,255,255,0.05)"}}),e.jsx(l,{variant:"overline",sx:{color:i.text.muted,px:2,display:"block"},children:"Services"}),e.jsx(h,{label:"Running Services",value1:r?.servicesCount?.running?.toString(),value2:o?.servicesCount?.running?.toString()}),e.jsx(h,{label:"Total Services",value1:r?.servicesCount?.total?.toString(),value2:o?.servicesCount?.total?.toString()}),e.jsx(T,{sx:{my:2,borderColor:"rgba(255,255,255,0.05)"}}),e.jsx(l,{variant:"overline",sx:{color:i.text.muted,px:2,display:"block"},children:"Docker"}),e.jsx(h,{label:"Docker Version",value1:r?.dockerInfo?.ServerVersion,value2:o?.dockerInfo?.ServerVersion}),e.jsx(h,{label:"Containers Running",value1:r?.dockerInfo?.ContainersRunning?.toString(),value2:o?.dockerInfo?.ContainersRunning?.toString()}),e.jsx(h,{label:"Images",value1:r?.dockerInfo?.Images?.toString(),value2:o?.dockerInfo?.Images?.toString()})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,p:2,borderTop:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs(L,{variant:"outlined",disabled:!t,onClick:()=>b(`/machines/${t}`),sx:{borderColor:"#f97316",color:"#f97316"},children:["View ",r?.machine?.name||"Machine 1"]}),e.jsxs(L,{variant:"outlined",disabled:!s,onClick:()=>b(`/machines/${s}`),sx:{borderColor:"#22c55e",color:"#22c55e"},children:["View ",o?.machine?.name||"Machine 2"]})]})]}),!t&&!s&&e.jsxs(A,{sx:{p:6,textAlign:"center",bgcolor:"rgba(255,255,255,0.02)"},children:[e.jsx(D,{sx:{fontSize:64,color:"rgba(255,255,255,0.1)",mb:2}}),e.jsx(l,{sx:{color:i.text.muted,mb:1},children:"Select two machines to compare"}),e.jsx(l,{variant:"body2",sx:{color:i.text.disabled},children:"Compare system configurations, health metrics, and service status"})]})]})};export{de as default};

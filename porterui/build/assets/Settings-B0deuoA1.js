import{ah as ae,ai as ie,r as l,aj as le,j as e,ak as B,J as ee,ap as Pe,al as ce,am as de,c as Ce,aq as ot,ar as me,a as $e,B as o,w as ne,T as r,b as _,R as Fe,e as F,a0 as nt,p as Ne,l as Z,m as G,D as je,x as ye,y as Se,k as q,a4 as at,a5 as it,a2 as lt,n as ue,s as ct,ac as se,g as t,as as dt,f as U,A as xt,P as Ie,i as pt,ag as ht,d as mt}from"./index-BR8HzIu-.js";import{S as Le}from"./Schedule-B50FmDRN.js";import{D as Ue}from"./Delete-DwUrccAH.js";import{E as Je}from"./Edit-BSjMYvVA.js";import{P as ut}from"./Pause-CU6NakRL.js";import{S as bt}from"./Save-Dlv0N-to.js";import{S as gt}from"./Star-B4L1ngbP.js";import{A as Me}from"./ArrowBack-fMblk9rH.js";import{a as be,R as ft,A as jt,g as _e,p as Te}from"./presets-IJFGqX13.js";import{C as yt}from"./CheckCircle-CQPaGP6K.js";import{P as St,A as vt}from"./AdminPanelSettings-CHq-emmp.js";import{T as Ct}from"./TableContainer-BAqttMGo.js";import{T as kt,a as zt,b as Ae,c as J,d as wt}from"./TableRow-BgXj_boL.js";import{C as O}from"./Chip-CiJfAjDW.js";import{F as re}from"./FormControlLabel-DDgFjoWt.js";import{S as oe}from"./Switch-HbuDhUMd.js";import{D as ve}from"./DialogActions-BOBerqwj.js";import{C as Ee}from"./Checkbox-DjmnloIS.js";import{S as Rt}from"./Snackbar-BK8x6uGU.js";import"./SwitchBase-CXhs4CjE.js";function Wt(n){return ae("MuiStepper",n)}ie("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const pe=l.createContext({}),ke=l.createContext({});function It(n){return ae("MuiStepConnector",n)}ie("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const Lt=n=>{const{classes:c,orientation:d,alternativeLabel:h,active:p,completed:g,disabled:S}=n,j={root:["root",d,h&&"alternativeLabel",p&&"active",g&&"completed",S&&"disabled"],line:["line",`line${Pe(d)}`]};return ce(j,It,c)},Mt=B("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(n,c)=>{const{ownerState:d}=n;return[c.root,c[d.orientation],d.alternativeLabel&&c.alternativeLabel,d.completed&&c.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),_t=B("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(n,c)=>{const{ownerState:d}=n;return[c.line,c[`line${Pe(d.orientation)}`]]}})(de(({theme:n})=>{const c=n.palette.mode==="light"?n.palette.grey[400]:n.palette.grey[600];return{display:"block",borderColor:n.vars?n.vars.palette.StepConnector.border:c,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),Tt=l.forwardRef(function(c,d){const h=le({props:c,name:"MuiStepConnector"}),{className:p,...g}=h,{alternativeLabel:S,orientation:j="horizontal"}=l.useContext(pe),{active:v,disabled:u,completed:y}=l.useContext(ke),b={...h,alternativeLabel:S,orientation:j,active:v,completed:y,disabled:u},f=Lt(b);return e.jsx(Mt,{className:ee(f.root,p),ref:d,ownerState:b,...g,children:e.jsx(_t,{className:f.line,ownerState:b})})}),At=n=>{const{orientation:c,nonLinear:d,alternativeLabel:h,classes:p}=n;return ce({root:["root",c,d&&"nonLinear",h&&"alternativeLabel"]},Wt,p)},Et=B("div",{name:"MuiStepper",slot:"Root",overridesResolver:(n,c)=>{const{ownerState:d}=n;return[c.root,c[d.orientation],d.alternativeLabel&&c.alternativeLabel,d.nonLinear&&c.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),Dt=e.jsx(Tt,{}),Pt=l.forwardRef(function(c,d){const h=le({props:c,name:"MuiStepper"}),{activeStep:p=0,alternativeLabel:g=!1,children:S,className:j,component:v="div",connector:u=Dt,nonLinear:y=!1,orientation:b="horizontal",...f}=h,A={...h,nonLinear:y,alternativeLabel:g,orientation:b,component:v},z=At(A),W=l.Children.toArray(S).filter(Boolean),C=W.map((i,m)=>l.cloneElement(i,{index:m,last:m+1===W.length,...i.props})),E=l.useMemo(()=>({activeStep:p,alternativeLabel:g,connector:u,nonLinear:y,orientation:b}),[p,g,u,y,b]);return e.jsx(pe.Provider,{value:E,children:e.jsx(Et,{as:v,ownerState:A,className:ee(z.root,j),ref:d,...f,children:C})})});function $t(n){return ae("MuiStep",n)}ie("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Ft=n=>{const{classes:c,orientation:d,alternativeLabel:h,completed:p}=n;return ce({root:["root",d,h&&"alternativeLabel",p&&"completed"]},$t,c)},Nt=B("div",{name:"MuiStep",slot:"Root",overridesResolver:(n,c)=>{const{ownerState:d}=n;return[c.root,c[d.orientation],d.alternativeLabel&&c.alternativeLabel,d.completed&&c.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),Ut=l.forwardRef(function(c,d){const h=le({props:c,name:"MuiStep"}),{active:p,children:g,className:S,component:j="div",completed:v,disabled:u,expanded:y=!1,index:b,last:f,...A}=h,{activeStep:z,connector:W,alternativeLabel:C,orientation:E,nonLinear:i}=l.useContext(pe);let[m=!1,L=!1,D=!1]=[p,v,u];z===b?m=p!==void 0?p:!0:!i&&z>b?L=v!==void 0?v:!0:!i&&z<b&&(D=u!==void 0?u:!0);const M=l.useMemo(()=>({index:b,last:f,expanded:y,icon:b+1,active:m,completed:L,disabled:D}),[b,f,y,m,L,D]),I={...h,active:m,orientation:E,alternativeLabel:C,completed:L,disabled:D,expanded:y,component:j},w=Ft(I),P=e.jsxs(Nt,{as:j,className:ee(w.root,S),ref:d,ownerState:I,...A,children:[W&&C&&b!==0?W:null,g]});return e.jsx(ke.Provider,{value:M,children:W&&!C&&b!==0?e.jsxs(l.Fragment,{children:[W,P]}):P})}),Jt=Ce(e.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),Ot=Ce(e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function Bt(n){return ae("MuiStepIcon",n)}const ge=ie("MuiStepIcon",["root","active","completed","error","text"]);var De;const Vt=n=>{const{classes:c,active:d,completed:h,error:p}=n;return ce({root:["root",d&&"active",h&&"completed",p&&"error"],text:["text"]},Bt,c)},fe=B(ot,{name:"MuiStepIcon",slot:"Root"})(de(({theme:n})=>({display:"block",transition:n.transitions.create("color",{duration:n.transitions.duration.shortest}),color:(n.vars||n).palette.text.disabled,[`&.${ge.completed}`]:{color:(n.vars||n).palette.primary.main},[`&.${ge.active}`]:{color:(n.vars||n).palette.primary.main},[`&.${ge.error}`]:{color:(n.vars||n).palette.error.main}}))),Ht=B("text",{name:"MuiStepIcon",slot:"Text"})(de(({theme:n})=>({fill:(n.vars||n).palette.primary.contrastText,fontSize:n.typography.caption.fontSize,fontFamily:n.typography.fontFamily}))),Yt=l.forwardRef(function(c,d){const h=le({props:c,name:"MuiStepIcon"}),{active:p=!1,className:g,completed:S=!1,error:j=!1,icon:v,...u}=h,y={...h,active:p,completed:S,error:j},b=Vt(y);if(typeof v=="number"||typeof v=="string"){const f=ee(g,b.root);return j?e.jsx(fe,{as:Ot,className:f,ref:d,ownerState:y,...u}):S?e.jsx(fe,{as:Jt,className:f,ref:d,ownerState:y,...u}):e.jsxs(fe,{className:f,ref:d,ownerState:y,...u,children:[De||(De=e.jsx("circle",{cx:"12",cy:"12",r:"12"})),e.jsx(Ht,{className:b.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:y,children:v})]})}return v});function qt(n){return ae("MuiStepLabel",n)}const K=ie("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Kt=n=>{const{classes:c,orientation:d,active:h,completed:p,error:g,disabled:S,alternativeLabel:j}=n;return ce({root:["root",d,g&&"error",S&&"disabled",j&&"alternativeLabel"],label:["label",h&&"active",p&&"completed",g&&"error",S&&"disabled",j&&"alternativeLabel"],iconContainer:["iconContainer",h&&"active",p&&"completed",g&&"error",S&&"disabled",j&&"alternativeLabel"],labelContainer:["labelContainer",j&&"alternativeLabel"]},qt,c)},Gt=B("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(n,c)=>{const{ownerState:d}=n;return[c.root,c[d.orientation]]}})({display:"flex",alignItems:"center",[`&.${K.alternativeLabel}`]:{flexDirection:"column"},[`&.${K.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),Qt=B("span",{name:"MuiStepLabel",slot:"Label"})(de(({theme:n})=>({...n.typography.body2,display:"block",transition:n.transitions.create("color",{duration:n.transitions.duration.shortest}),[`&.${K.active}`]:{color:(n.vars||n).palette.text.primary,fontWeight:500},[`&.${K.completed}`]:{color:(n.vars||n).palette.text.primary,fontWeight:500},[`&.${K.alternativeLabel}`]:{marginTop:16},[`&.${K.error}`]:{color:(n.vars||n).palette.error.main}}))),Xt=B("span",{name:"MuiStepLabel",slot:"IconContainer"})({flexShrink:0,display:"flex",paddingRight:8,[`&.${K.alternativeLabel}`]:{paddingRight:0}}),Zt=B("span",{name:"MuiStepLabel",slot:"LabelContainer"})(de(({theme:n})=>({width:"100%",color:(n.vars||n).palette.text.secondary,[`&.${K.alternativeLabel}`]:{textAlign:"center"}}))),Oe=l.forwardRef(function(c,d){const h=le({props:c,name:"MuiStepLabel"}),{children:p,className:g,componentsProps:S={},error:j=!1,icon:v,optional:u,slots:y={},slotProps:b={},StepIconComponent:f,StepIconProps:A,...z}=h,{alternativeLabel:W,orientation:C}=l.useContext(pe),{active:E,disabled:i,completed:m,icon:L}=l.useContext(ke),D=v||L;let M=f;D&&!M&&(M=Yt);const I={...h,active:E,alternativeLabel:W,completed:m,disabled:i,error:j,orientation:C},w=Kt(I),P={slots:y,slotProps:{stepIcon:A,...S,...b}},[a,T]=me("root",{elementType:Gt,externalForwardedProps:{...P,...z},ownerState:I,ref:d,className:ee(w.root,g)}),[R,N]=me("label",{elementType:Qt,externalForwardedProps:P,ownerState:I}),[$,V]=me("stepIcon",{elementType:M,externalForwardedProps:P,ownerState:I});return e.jsxs(a,{...T,children:[D||$?e.jsx(Xt,{className:w.iconContainer,ownerState:I,children:e.jsx($,{completed:m,active:E,error:j,icon:D,...V})}):null,e.jsxs(Zt,{className:w.labelContainer,ownerState:I,children:[p?e.jsx(R,{...N,className:ee(w.label,N?.className),children:p}):null,u]})]})});Oe.muiName="StepLabel";const xe={admin:"#ef4444",operator:"#f97316",viewer:"#22c55e"},es={admin:vt,operator:Ne,viewer:nt},ts=()=>{const{user:n,isAdmin:c}=$e(),[d,h]=l.useState([]),[p,g]=l.useState([]),[S,j]=l.useState(!0),[v,u]=l.useState(""),[y,b]=l.useState(""),[f,A]=l.useState(!1),[z,W]=l.useState(null),[C,E]=l.useState(null),[i,m]=l.useState({username:"",email:"",password:"",role:"viewer",display_name:"",is_active:!0}),L=l.useCallback(async()=>{try{const a=await fetch("/api/users");if(a.ok){const T=await a.json();h(T||[])}}catch{u("Failed to load users")}j(!1)},[]),D=l.useCallback(async()=>{try{const a=await fetch("/api/roles");if(a.ok){const T=await a.json();g(T||[])}}catch(a){console.error("Failed to load roles:",a)}},[]);l.useEffect(()=>{L(),D()},[L,D]);const M=(a=null)=>{a?(W(a),m({username:a.username,email:a.email||"",password:"",role:a.role,display_name:a.display_name||"",is_active:a.is_active})):(W(null),m({username:"",email:"",password:"",role:"viewer",display_name:"",is_active:!0})),A(!0)},I=()=>{A(!1),W(null),u("")},w=async()=>{if(u(""),b(""),!i.username){u("Username is required");return}if(!z&&!i.password){u("Password is required for new users");return}if(i.password&&i.password.length<6){u("Password must be at least 6 characters");return}try{const a=z?`/api/users/${z.id}`:"/api/users",T=z?"PUT":"POST",R={...i};R.password||delete R.password;const $=await(await fetch(a,{method:T,headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();$.success?(b(z?"User updated successfully":"User created successfully"),I(),L()):u($.error||"Operation failed")}catch{u("Network error")}},P=async a=>{try{const R=await(await fetch(`/api/users/${a}`,{method:"DELETE"})).json();R.success?(b("User deleted successfully"),L()):u(R.error||"Failed to delete user")}catch{u("Network error")}E(null)};return c()?e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(o,{children:[e.jsx(r,{variant:"h5",sx:{fontWeight:700,color:"#fafafa"},children:"User Management"}),e.jsx(r,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.9rem"},children:"Manage users and their access permissions"})]}),e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx(_,{startIcon:e.jsx(Fe,{}),onClick:L,sx:{color:"rgba(255,255,255,0.7)"},children:"Refresh"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(St,{}),onClick:()=>M(),children:"Add User"})]})]}),v&&e.jsx(ne,{severity:"error",sx:{mb:2},onClose:()=>u(""),children:v}),y&&e.jsx(ne,{severity:"success",sx:{mb:2},onClose:()=>b(""),children:y}),e.jsx(F,{sx:{background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.08)"},children:e.jsx(Ct,{children:e.jsxs(kt,{children:[e.jsx(zt,{children:e.jsxs(Ae,{children:[e.jsx(J,{sx:{color:"rgba(255,255,255,0.7)",fontWeight:600},children:"User"}),e.jsx(J,{sx:{color:"rgba(255,255,255,0.7)",fontWeight:600},children:"Role"}),e.jsx(J,{sx:{color:"rgba(255,255,255,0.7)",fontWeight:600},children:"Status"}),e.jsx(J,{sx:{color:"rgba(255,255,255,0.7)",fontWeight:600},children:"Last Login"}),e.jsx(J,{sx:{color:"rgba(255,255,255,0.7)",fontWeight:600},align:"right",children:"Actions"})]})}),e.jsx(wt,{children:d.map(a=>{const T=es[a.role]||Ne;return e.jsxs(Ae,{sx:{"&:hover":{background:"rgba(255,255,255,0.02)"}},children:[e.jsx(J,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(o,{sx:{width:36,height:36,borderRadius:"50%",background:`${xe[a.role]}20`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(T,{sx:{fontSize:18,color:xe[a.role]}})}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:"#fafafa",fontWeight:500},children:a.display_name||a.username}),e.jsx(r,{sx:{color:"rgba(255,255,255,0.4)",fontSize:"0.8rem"},children:a.email||a.username})]})]})}),e.jsx(J,{children:e.jsx(O,{label:a.role,size:"small",sx:{background:`${xe[a.role]}20`,color:xe[a.role],fontWeight:600,textTransform:"capitalize"}})}),e.jsx(J,{children:e.jsx(O,{label:a.is_active?"Active":"Disabled",size:"small",sx:{background:a.is_active?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",color:a.is_active?"#22c55e":"#ef4444"}})}),e.jsx(J,{children:e.jsx(r,{sx:{color:"rgba(255,255,255,0.5)",fontSize:"0.85rem"},children:a.last_login?new Date(a.last_login).toLocaleString():"Never"})}),e.jsxs(J,{align:"right",children:[e.jsx(Z,{title:"Edit",children:e.jsx(G,{size:"small",onClick:()=>M(a),sx:{color:"rgba(255,255,255,0.5)","&:hover":{color:"#f97316"}},children:e.jsx(Je,{fontSize:"small"})})}),a.id!==n?.id&&e.jsx(Z,{title:"Delete",children:e.jsx(G,{size:"small",onClick:()=>E(a),sx:{color:"rgba(255,255,255,0.5)","&:hover":{color:"#ef4444"}},children:e.jsx(Ue,{fontSize:"small"})})})]})]},a.id)})})]})})}),e.jsxs(je,{open:f,onClose:I,maxWidth:"sm",fullWidth:!0,children:[e.jsx(ye,{sx:{background:"rgba(0,0,0,0.3)"},children:z?"Edit User":"Add New User"}),e.jsx(Se,{sx:{pt:3},children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(q,{label:"Username",value:i.username,onChange:a=>m({...i,username:a.target.value}),disabled:!!z,fullWidth:!0}),e.jsx(q,{label:"Display Name",value:i.display_name,onChange:a=>m({...i,display_name:a.target.value}),fullWidth:!0}),e.jsx(q,{label:"Email",type:"email",value:i.email,onChange:a=>m({...i,email:a.target.value}),fullWidth:!0}),e.jsx(q,{label:z?"New Password (leave blank to keep current)":"Password",type:"password",value:i.password,onChange:a=>m({...i,password:a.target.value}),fullWidth:!0}),e.jsxs(at,{fullWidth:!0,children:[e.jsx(it,{children:"Role"}),e.jsxs(lt,{value:i.role,label:"Role",onChange:a=>m({...i,role:a.target.value}),children:[e.jsx(ue,{value:"admin",children:"Admin - Full access"}),e.jsx(ue,{value:"operator",children:"Operator - Execute scripts, manage machines"}),e.jsx(ue,{value:"viewer",children:"Viewer - Read-only access"})]})]}),z&&e.jsx(re,{control:e.jsx(oe,{checked:i.is_active,onChange:a=>m({...i,is_active:a.target.checked})}),label:"Account Active"})]})}),e.jsxs(ve,{sx:{p:2,background:"rgba(0,0,0,0.2)"},children:[e.jsx(_,{onClick:I,children:"Cancel"}),e.jsx(_,{variant:"contained",onClick:w,children:z?"Save Changes":"Create User"})]})]}),e.jsxs(je,{open:!!C,onClose:()=>E(null),children:[e.jsx(ye,{children:"Delete User"}),e.jsx(Se,{children:e.jsxs(r,{children:["Are you sure you want to delete user ",e.jsx("strong",{children:C?.username}),"? This action cannot be undone."]})}),e.jsxs(ve,{children:[e.jsx(_,{onClick:()=>E(null),children:"Cancel"}),e.jsx(_,{variant:"contained",color:"error",onClick:()=>P(C.id),children:"Delete"})]})]})]}):e.jsx(o,{sx:{p:3},children:e.jsx(ne,{severity:"warning",children:"You don't have permission to manage users. Only administrators can access this page."})})},ss=Ce(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),Cs=()=>{const{isAdmin:n,canWrite:c,canExecute:d}=$e(),h=c("scheduler")||d(),[p,g]=l.useState("scheduler"),[S,j]=l.useState([]),[v,u]=l.useState([]),[y,b]=l.useState([]),[f,A]=l.useState({enabled:!0,slack_webhook:"",on_success:!1,on_failure:!0}),[z,W]=l.useState(!1),[C,E]=l.useState(null),[i,m]=l.useState({name:"",description:"",script_path:"",args:"",machine_ids:[],cron_expr:"0 0 * * * *",enabled:!0}),[L,D]=l.useState({open:!1,message:"",severity:"success"}),[M,I]=l.useState(0),[w,P]=l.useState(null),[a,T]=l.useState(null),[R,N]=l.useState(null),[$,V]=l.useState({}),[Be,he]=l.useState(!1),Q=l.useCallback(async()=>{try{const x=await(await fetch("/api/scheduler/jobs")).json();j(x||[])}catch(s){console.error("Failed to load jobs:",s)}},[]),ze=l.useCallback(async()=>{try{const x=await(await fetch("/api/machines")).json();u(x||[])}catch(s){console.error("Failed to load machines:",s)}},[]),we=l.useCallback(async()=>{try{const x=await(await fetch("/api/scripts")).json();b(x||[])}catch(s){console.error("Failed to load scripts:",s)}},[]),Re=l.useCallback(async()=>{try{const x=await(await fetch("/api/notifications/config")).json();A(x||{})}catch(s){console.error("Failed to load notification config:",s)}},[]);l.useEffect(()=>{Q(),ze(),we(),Re()},[Q,ze,we,Re]);const H=(s,x="success")=>{D({open:!0,message:s,severity:x})},Ve=async()=>{try{const s=C?"PUT":"POST",x=C?`/api/scheduler/jobs/${C.id}`:"/api/scheduler/jobs",k=We(),Y=R?.name||"";await fetch(x,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,args:k,description:Y?`${Y} - ${i.description||""}`.trim():i.description})}),W(!1),E(null),I(0),P(null),T(null),N(null),V({}),m({name:"",description:"",script_path:"",args:"",machine_ids:[],cron_expr:"0 0 * * * *",enabled:!0}),Q(),H(C?"Job updated":"Job created")}catch{H("Failed to save job","error")}},He=async s=>{if(window.confirm("Delete this scheduled job?"))try{await fetch(`/api/scheduler/jobs/${s}`,{method:"DELETE"}),Q(),H("Job deleted")}catch{H("Failed to delete job","error")}},Ye=async s=>{try{await fetch(`/api/scheduler/jobs/${s}/toggle`,{method:"POST"}),Q()}catch{H("Failed to toggle job","error")}},qe=async s=>{try{await fetch(`/api/scheduler/jobs/${s}/run`,{method:"POST"}),H("Job execution started")}catch{H("Failed to run job","error")}},Ke=s=>{E(s),m({name:s.name||"",description:s.description||"",script_path:s.script_path||"",args:s.args||"",machine_ids:s.machine_ids||[],cron_expr:s.cron_expr||"0 0 * * * *",enabled:s.enabled});const x=y.find(k=>k.path===s.script_path);if(x){P(x);const k=_e(x.path);T(k)}I(3),W(!0)},Ge=s=>{P(s),m(te=>({...te,script_path:s.path,name:s.name}));const x=_e(s.path);T(x);const k={};s.flags?.forEach(te=>{k[te.long]={enabled:!1,value:""}}),V(k);const Y=x?.presets?.find(te=>te.recommended);Y?(N(Y),V(Te(Y,s.flags))):N(null)},Qe=s=>{N(s),!a?.useArgs&&w&&V(Te(s,w.flags))},Xe=s=>{N(null),V(x=>({...x,[s]:{...x[s],enabled:!x[s]?.enabled}}))},Ze=(s,x)=>{V(k=>({...k,[s]:{...k[s],value:x}}))},We=()=>{if(a?.useArgs&&R?.args)return R.args;if(R?.flags?.length>0)return R.flags.join(" ");const s=[];return Object.entries($).forEach(([x,k])=>{k.enabled&&s.push(k.value?`${x}=${k.value}`:x)}),s.length===0&&i.args?i.args:s.join(" ")},et=()=>{E(null),I(0),P(null),T(null),N(null),V({}),he(!1),m({name:"",description:"",script_path:"",args:"",machine_ids:[],cron_expr:"0 0 * * * *",enabled:!0}),W(!0)},tt=["Select Script","Configure Options","Select Machines","Schedule"],X=()=>{switch(M){case 0:return w!==null;case 1:return!0;case 2:return i.machine_ids.length>0;case 3:return i.name&&i.cron_expr;default:return!0}},st=async()=>{try{await fetch("/api/notifications/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),H("Notification settings saved")}catch{H("Failed to save settings","error")}},rt=[{label:"Every minute",value:"0 * * * * *",description:"Runs at the start of every minute"},{label:"Every 5 minutes",value:"0 */5 * * * *",description:"Runs every 5 minutes (0, 5, 10, 15...)"},{label:"Every 15 minutes",value:"0 */15 * * * *",description:"Runs every 15 minutes (0, 15, 30, 45)"},{label:"Every 30 minutes",value:"0 */30 * * * *",description:"Runs every 30 minutes (0, 30)"},{label:"Every hour",value:"0 0 * * * *",description:"Runs at the start of every hour"},{label:"Every 6 hours",value:"0 0 */6 * * *",description:"Runs at 12am, 6am, 12pm, 6pm"},{label:"Every day at midnight",value:"0 0 0 * * *",description:"Runs once daily at 12:00 AM"},{label:"Every day at 9am",value:"0 0 9 * * *",description:"Runs once daily at 9:00 AM"},{label:"Every day at 6pm",value:"0 0 18 * * *",description:"Runs once daily at 6:00 PM"},{label:"Every Monday at 9am",value:"0 0 9 * * 1",description:"Runs weekly on Monday at 9:00 AM"},{label:"Every weekday at 9am",value:"0 0 9 * * 1-5",description:"Runs Mon-Fri at 9:00 AM"},{label:"First of month at midnight",value:"0 0 0 1 * *",description:"Runs on the 1st of each month"}];return e.jsxs(o,{sx:ct.pageContainer,children:[e.jsx(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(o,{children:[e.jsx(r,{sx:{fontSize:"1.8rem",fontWeight:800,background:se.text,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Settings"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem"},children:"Configure scheduled jobs and notifications"})]})}),e.jsxs(o,{sx:{display:"flex",gap:1,mb:3},children:[e.jsx(_,{startIcon:e.jsx(Le,{}),onClick:()=>g("scheduler"),sx:{px:3,py:1,borderRadius:"12px",background:p==="scheduler"?"rgba(249, 115, 22, 0.15)":"rgba(255,255,255,0.03)",color:p==="scheduler"?t.primary:t.text.secondary,border:p==="scheduler"?`1px solid ${t.primary}`:"1px solid transparent",textTransform:"none",fontWeight:600},children:"Scheduled Jobs"}),e.jsx(_,{startIcon:e.jsx(dt,{}),onClick:()=>g("notifications"),sx:{px:3,py:1,borderRadius:"12px",background:p==="notifications"?"rgba(249, 115, 22, 0.15)":"rgba(255,255,255,0.03)",color:p==="notifications"?t.primary:t.text.secondary,border:p==="notifications"?`1px solid ${t.primary}`:"1px solid transparent",textTransform:"none",fontWeight:600},children:"Notifications"}),n()&&e.jsx(_,{startIcon:e.jsx(ss,{}),onClick:()=>g("users"),sx:{px:3,py:1,borderRadius:"12px",background:p==="users"?"rgba(249, 115, 22, 0.15)":"rgba(255,255,255,0.03)",color:p==="users"?t.primary:t.text.secondary,border:p==="users"?`1px solid ${t.primary}`:"1px solid transparent",textTransform:"none",fontWeight:600},children:"Users"})]}),p==="scheduler"&&e.jsxs(o,{children:[e.jsx(F,{sx:{background:"rgba(255, 170, 0, 0.05)",border:"1px solid rgba(255, 170, 0, 0.2)",borderRadius:"12px",mb:3},children:e.jsxs(U,{sx:{py:2},children:[e.jsx(r,{sx:{color:t.warning,fontWeight:600,fontSize:"1rem",mb:2},children:"ðŸ“… Understanding Cron Expressions"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.85rem",mb:2},children:"A cron expression has 6 fields that define when a job runs. Read left to right:"}),e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:1.5,mb:2},children:[e.jsxs(o,{sx:{background:"rgba(249, 115, 22, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.primary,fontSize:"0.8rem",fontWeight:700},children:"1. SECOND"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-59"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which second"})]}),e.jsxs(o,{sx:{background:"rgba(34, 197, 94, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.secondary,fontSize:"0.8rem",fontWeight:700},children:"2. MINUTE"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-59"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which minute"})]}),e.jsxs(o,{sx:{background:"rgba(255, 170, 0, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.warning,fontSize:"0.8rem",fontWeight:700},children:"3. HOUR"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-23"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"24h format"})]}),e.jsxs(o,{sx:{background:"rgba(255, 68, 102, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.error,fontSize:"0.8rem",fontWeight:700},children:"4. DAY"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"1-31"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Day of month"})]}),e.jsxs(o,{sx:{background:"rgba(136, 68, 255, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:"#8844ff",fontSize:"0.8rem",fontWeight:700},children:"5. MONTH"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"1-12"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which month"})]}),e.jsxs(o,{sx:{background:"rgba(0, 170, 255, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:"#00aaff",fontSize:"0.8rem",fontWeight:700},children:"6. WEEKDAY"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-6"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Sun=0, Sat=6"})]})]}),e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.8rem",fontWeight:600,mb:1},children:"Special Characters:"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("strong",{style:{color:t.primary},children:"*"})," = any value (every)"]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("strong",{style:{color:t.primary},children:"*/5"})," = every 5 units"]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("strong",{style:{color:t.primary},children:"1-5"})," = range (1 through 5)"]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("strong",{style:{color:t.primary},children:"1,15"})," = specific values"]})]})]}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.8rem",fontWeight:600,mb:1},children:"Examples:"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("code",{style:{color:t.primary},children:"0 0 9 * * *"})," = Daily at 9am"]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("code",{style:{color:t.primary},children:"0 */30 * * * *"})," = Every 30 min"]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("code",{style:{color:t.primary},children:"0 0 9 * * 1-5"})," = Weekdays 9am"]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:[e.jsx("code",{style:{color:t.primary},children:"0 0 0 1 * *"})," = 1st of month"]})]})]})]})]})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(r,{sx:{color:t.text.primary,fontWeight:600},children:["Scheduled Jobs (",S.length,")"]}),e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx(G,{onClick:Q,sx:{color:t.text.secondary},children:e.jsx(Fe,{})}),h&&e.jsx(_,{startIcon:e.jsx(xt,{}),onClick:et,sx:{background:se.primary,color:"#0a0a0f",fontWeight:600,textTransform:"none",borderRadius:"10px"},children:"New Job"})]})]}),S.length===0?e.jsxs(F,{sx:{background:t.background.glass,border:`1px solid ${t.border.light}`,borderRadius:"16px",textAlign:"center",py:6},children:[e.jsx(Le,{sx:{fontSize:48,color:t.text.disabled,mb:2}}),e.jsx(r,{sx:{color:t.text.muted},children:"No scheduled jobs yet"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.85rem"},children:"Create a job to run scripts automatically"})]}):S.map(s=>e.jsx(F,{sx:{background:t.background.glass,border:`1px solid ${t.border.light}`,borderRadius:"12px",mb:2,opacity:s.enabled?1:.6},children:e.jsx(U,{children:e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(o,{sx:{flex:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600},children:s.name}),e.jsx(O,{label:s.enabled?"Active":"Paused",size:"small",sx:{background:s.enabled?"rgba(34, 197, 94, 0.1)":"rgba(255,255,255,0.05)",color:s.enabled?t.secondary:t.text.disabled,height:20,fontSize:"0.7rem"}})]}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.85rem",mb:1},children:s.description||s.script_path}),e.jsxs(o,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.8rem"},children:[e.jsx("strong",{children:"Cron:"})," ",s.cron_expr]}),e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.8rem"},children:[e.jsx("strong",{children:"Machines:"})," ",s.machine_ids?.length||0]}),s.last_run&&e.jsxs(r,{sx:{color:t.text.disabled,fontSize:"0.8rem"},children:[e.jsx("strong",{children:"Last run:"})," ",new Date(s.last_run).toLocaleString()]}),s.next_run&&e.jsxs(r,{sx:{color:t.primary,fontSize:"0.8rem"},children:[e.jsx("strong",{children:"Next:"})," ",new Date(s.next_run).toLocaleString()]})]})]}),e.jsxs(o,{sx:{display:"flex",gap:.5},children:[h&&e.jsx(Z,{title:"Run now",children:e.jsx(G,{size:"small",onClick:()=>qe(s.id),sx:{color:t.secondary},children:e.jsx(Ie,{})})}),h&&e.jsx(Z,{title:s.enabled?"Pause":"Resume",children:e.jsx(G,{size:"small",onClick:()=>Ye(s.id),sx:{color:t.warning},children:s.enabled?e.jsx(ut,{}):e.jsx(Ie,{})})}),h&&e.jsx(Z,{title:"Edit",children:e.jsx(G,{size:"small",onClick:()=>Ke(s),sx:{color:t.text.secondary},children:e.jsx(Je,{})})}),h&&e.jsx(Z,{title:"Delete",children:e.jsx(G,{size:"small",onClick:()=>He(s.id),sx:{color:t.error},children:e.jsx(Ue,{})})})]})]})})},s.id))]}),p==="notifications"&&e.jsx(F,{sx:{background:t.background.glass,border:`1px solid ${t.border.light}`,borderRadius:"16px"},children:e.jsxs(U,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600,mb:3},children:"Notification Settings"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(re,{control:e.jsx(oe,{checked:f.enabled,onChange:s=>A({...f,enabled:s.target.checked}),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:t.primary}}}),label:"Enable notifications",sx:{color:t.text.primary}}),e.jsx(q,{label:"Slack Webhook URL",value:f.slack_webhook||"",onChange:s=>A({...f,slack_webhook:s.target.value}),placeholder:"https://hooks.slack.com/services/...",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.2)",borderRadius:"12px"}}}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:1},children:"Send notifications on:"}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(re,{control:e.jsx(oe,{checked:f.on_success,onChange:s=>A({...f,on_success:s.target.checked}),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:t.secondary}}}),label:"Success",sx:{color:t.text.secondary}}),e.jsx(re,{control:e.jsx(oe,{checked:f.on_failure,onChange:s=>A({...f,on_failure:s.target.checked}),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:t.error}}}),label:"Failure",sx:{color:t.text.secondary}})]})]}),e.jsx(_,{startIcon:e.jsx(bt,{}),onClick:st,sx:{background:se.primary,color:"#0a0a0f",fontWeight:600,textTransform:"none",borderRadius:"10px",alignSelf:"flex-start",px:3},children:"Save Settings"})]})]})}),p==="users"&&n()&&e.jsx(ts,{}),e.jsxs(je,{open:z,onClose:()=>W(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{background:t.background.card,borderRadius:"16px",border:`1px solid ${t.border.light}`,minHeight:"70vh"}},children:[e.jsx(ye,{sx:{color:t.text.primary,borderBottom:`1px solid ${t.border.light}`},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(r,{sx:{fontWeight:700,fontSize:"1.3rem"},children:C?"Edit Scheduled Job":"Create Scheduled Job"}),!C&&e.jsx(Pt,{activeStep:M,sx:{flex:1,ml:4},children:tt.map(s=>e.jsx(Ut,{children:e.jsx(Oe,{sx:{"& .MuiStepLabel-label":{color:t.text.secondary}},children:s})},s))})]})}),e.jsxs(Se,{sx:{p:3},children:[M===0&&e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600,mb:1},children:"Which script do you want to schedule?"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:3},children:"Click on a script to select it"}),e.jsx(o,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:2},children:y.map(s=>e.jsx(F,{onClick:()=>Ge(s),sx:{background:w?.path===s.path?"rgba(249, 115, 22, 0.15)":t.background.glass,border:w?.path===s.path?`2px solid ${t.primary}`:`1px solid ${t.border.light}`,borderRadius:"12px",cursor:"pointer",transition:"all 0.2s","&:hover":{borderColor:t.primary,transform:"translateY(-2px)"}},children:e.jsx(U,{sx:{p:2},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(be,{checked:w?.path===s.path,sx:{p:0}}),e.jsx(pt,{sx:{color:t.primary}}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600},children:s.name}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:s.description?.substring(0,60)||s.path})]})]})})},s.path))})]}),M===1&&w&&e.jsxs(o,{children:[e.jsxs(r,{sx:{color:t.text.primary,fontWeight:600,mb:1},children:["Configure ",w.name]}),a?.presets?.length>0&&!Be?e.jsxs(e.Fragment,{children:[e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:3},children:"Select a preset configuration or use advanced mode for custom flags"}),e.jsx(ft,{value:R?.id||"",children:a.presets.map(s=>e.jsx(F,{onClick:()=>Qe(s),sx:{mb:2,background:R?.id===s.id?"rgba(249, 115, 22, 0.15)":t.background.glass,border:R?.id===s.id?`2px solid ${t.primary}`:`1px solid ${t.border.light}`,borderRadius:"12px",cursor:"pointer",transition:"all 0.2s","&:hover":{borderColor:t.primary}},children:e.jsx(U,{sx:{py:2},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{checked:R?.id===s.id,sx:{mr:2}}),e.jsxs(o,{sx:{flex:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600,fontSize:"1.1rem"},children:s.name}),s.recommended&&e.jsx(O,{label:"Recommended",size:"small",icon:e.jsx(gt,{}),sx:{background:"rgba(255, 170, 0, 0.2)",color:t.warning,height:22}})]}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.85rem",mt:.5},children:s.description}),s.flags&&e.jsx(o,{sx:{display:"flex",gap:.5,mt:1,flexWrap:"wrap"},children:s.flags.map((x,k)=>e.jsx(O,{label:x,size:"small",sx:{height:20,fontSize:"0.7rem",background:"rgba(0,0,0,0.3)"}},k))})]})]})})},s.id))}),e.jsx(_,{startIcon:e.jsx(ht,{}),onClick:()=>he(!0),sx:{color:t.text.secondary,textTransform:"none",mt:1},children:"Advanced: Configure flags manually"})]}):e.jsxs(e.Fragment,{children:[a?.presets?.length>0&&e.jsx(_,{startIcon:e.jsx(Me,{}),onClick:()=>he(!1),sx:{color:t.text.secondary,textTransform:"none",mb:2},children:"Back to presets"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:2},children:"Configure individual flags for this script"}),w.flags?.length>0?e.jsx(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:w.flags.map(s=>e.jsx(F,{sx:{background:$[s.long]?.enabled?"rgba(249, 115, 22, 0.1)":t.background.glass,border:`1px solid ${$[s.long]?.enabled?t.primary:t.border.light}`,borderRadius:"10px"},children:e.jsx(U,{sx:{py:1.5,px:2},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Ee,{checked:$[s.long]?.enabled||!1,onChange:()=>Xe(s.long)}),e.jsxs(o,{sx:{flex:1},children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:500,fontFamily:"monospace"},children:s.long}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.8rem"},children:s.description})]}),s.takes_value&&$[s.long]?.enabled&&e.jsx(q,{size:"small",placeholder:"Value",value:$[s.long]?.value||"",onChange:x=>Ze(s.long,x.target.value),sx:{width:150,"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.2)"}}})]})})},s.long))}):e.jsx(ne,{severity:"info",children:"This script has no configurable flags"})]})]}),M===2&&e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600,mb:1},children:"Which machines should run this job?"}),e.jsxs(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:3},children:["Select one or more machines. Selected: ",i.machine_ids.length]}),e.jsx(o,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:2},children:v.map(s=>{const x=i.machine_ids.includes(s.id);return e.jsx(F,{onClick:()=>{m(k=>({...k,machine_ids:x?k.machine_ids.filter(Y=>Y!==s.id):[...k.machine_ids,s.id]}))},sx:{background:x?"rgba(249, 115, 22, 0.15)":t.background.glass,border:x?`2px solid ${t.primary}`:`1px solid ${t.border.light}`,borderRadius:"12px",cursor:"pointer",transition:"all 0.2s","&:hover":{borderColor:t.primary}},children:e.jsx(U,{sx:{p:2},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(Ee,{checked:x,sx:{p:0}}),e.jsx(mt,{sx:{color:s.status==="online"?t.secondary:t.text.disabled}}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600},children:s.name}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.75rem",fontFamily:"monospace"},children:s.ip})]}),e.jsx(O,{label:s.status==="online"?"Online":"Offline",size:"small",sx:{ml:"auto",height:20,background:s.status==="online"?"rgba(34, 197, 94, 0.1)":"rgba(255,255,255,0.05)",color:s.status==="online"?t.secondary:t.text.disabled}})]})})},s.id)})})]}),M===3&&e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600,mb:1},children:"Set the schedule"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:3},children:"Configure when this job should run automatically"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(q,{label:"Job Name",value:i.name,onChange:s=>m({...i,name:s.target.value}),fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.2)",borderRadius:"12px"}}}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.9rem",mb:2},children:"Choose how often this job should run:"}),e.jsx(o,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:1.5,mb:3},children:rt.map(s=>e.jsx(F,{onClick:()=>m({...i,cron_expr:s.value}),sx:{background:i.cron_expr===s.value?"rgba(249, 115, 22, 0.15)":t.background.glass,border:i.cron_expr===s.value?`2px solid ${t.primary}`:`1px solid ${t.border.light}`,borderRadius:"10px",cursor:"pointer",transition:"all 0.2s","&:hover":{borderColor:t.primary,transform:"translateY(-1px)"}},children:e.jsx(U,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(be,{checked:i.cron_expr===s.value,size:"small",sx:{p:0}}),e.jsxs(o,{children:[e.jsx(r,{sx:{color:t.text.primary,fontWeight:600,fontSize:"0.9rem"},children:s.label}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.7rem"},children:s.description})]})]})})},s.value))}),e.jsx(F,{sx:{background:"rgba(255, 170, 0, 0.05)",border:"1px solid rgba(255, 170, 0, 0.2)",borderRadius:"12px",mb:2},children:e.jsxs(U,{sx:{py:2},children:[e.jsx(r,{sx:{color:t.warning,fontWeight:600,fontSize:"0.9rem",mb:2},children:"ðŸ“… Understanding Cron Expressions"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.8rem",mb:2},children:"A cron expression has 6 fields that define when the job runs. Read left to right:"}),e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:1.5,mb:2},children:[e.jsxs(o,{sx:{background:"rgba(249, 115, 22, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.primary,fontSize:"0.8rem",fontWeight:700},children:"1. SECOND"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-59"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which second of the minute"})]}),e.jsxs(o,{sx:{background:"rgba(34, 197, 94, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.secondary,fontSize:"0.8rem",fontWeight:700},children:"2. MINUTE"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-59"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which minute of the hour"})]}),e.jsxs(o,{sx:{background:"rgba(255, 170, 0, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.warning,fontSize:"0.8rem",fontWeight:700},children:"3. HOUR"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-23"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which hour (24h format)"})]}),e.jsxs(o,{sx:{background:"rgba(255, 68, 102, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:t.error,fontSize:"0.8rem",fontWeight:700},children:"4. DAY"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"1-31"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Day of the month"})]}),e.jsxs(o,{sx:{background:"rgba(136, 68, 255, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:"#8844ff",fontSize:"0.8rem",fontWeight:700},children:"5. MONTH"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"1-12"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"Which month"})]}),e.jsxs(o,{sx:{background:"rgba(0, 170, 255, 0.1)",p:1.5,borderRadius:"8px",textAlign:"center"},children:[e.jsx(r,{sx:{color:"#00aaff",fontSize:"0.8rem",fontWeight:700},children:"6. WEEKDAY"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.7rem",mt:.5},children:"0-6"}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.65rem",mt:.5},children:"0=Sun, 1=Mon...6=Sat"})]})]}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.8rem",fontWeight:600,mb:1},children:"Special Characters:"}),e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{label:"*",size:"small",sx:{fontFamily:"monospace",fontWeight:700,background:"rgba(0,0,0,0.3)"}}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:"Any value (every)"})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{label:"*/5",size:"small",sx:{fontFamily:"monospace",fontWeight:700,background:"rgba(0,0,0,0.3)"}}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:"Every 5 units"})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{label:"1-5",size:"small",sx:{fontFamily:"monospace",fontWeight:700,background:"rgba(0,0,0,0.3)"}}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:"Range (1 through 5)"})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{label:"1,15",size:"small",sx:{fontFamily:"monospace",fontWeight:700,background:"rgba(0,0,0,0.3)"}}),e.jsx(r,{sx:{color:t.text.disabled,fontSize:"0.75rem"},children:"Specific values (1 and 15)"})]})]}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.8rem",fontWeight:600,mt:2,mb:1},children:"Examples:"}),e.jsxs(o,{sx:{background:"rgba(0,0,0,0.2)",p:1.5,borderRadius:"8px"},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[e.jsx(r,{sx:{color:t.primary,fontSize:"0.75rem",fontFamily:"monospace"},children:"0 0 9 * * *"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.75rem"},children:"Every day at 9:00 AM"})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[e.jsx(r,{sx:{color:t.primary,fontSize:"0.75rem",fontFamily:"monospace"},children:"0 */30 * * * *"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.75rem"},children:"Every 30 minutes"})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(r,{sx:{color:t.primary,fontSize:"0.75rem",fontFamily:"monospace"},children:"0 0 9 * * 1-5"}),e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.75rem"},children:"Weekdays at 9:00 AM"})]})]})]})}),e.jsx(q,{label:"Custom Cron Expression",value:i.cron_expr,onChange:s=>m({...i,cron_expr:s.target.value}),fullWidth:!0,placeholder:"0 0 9 * * *",helperText:`Current: ${i.cron_expr}`,sx:{"& .MuiOutlinedInput-root":{background:"rgba(0,0,0,0.2)",borderRadius:"12px"}}})]}),e.jsx(re,{control:e.jsx(oe,{checked:i.enabled,onChange:s=>m({...i,enabled:s.target.checked}),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:t.secondary}}}),label:"Enable job immediately",sx:{color:t.text.primary}}),e.jsx(F,{sx:{background:"rgba(249, 115, 22, 0.05)",border:`1px solid ${t.border.light}`,borderRadius:"12px"},children:e.jsxs(U,{children:[e.jsx(r,{sx:{color:t.text.muted,fontSize:"0.85rem",mb:1},children:"Summary"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(r,{sx:{color:t.text.primary,fontSize:"0.9rem"},children:[e.jsx("strong",{children:"Script:"})," ",w?.name||i.script_path]}),R&&e.jsxs(r,{sx:{color:t.text.primary,fontSize:"0.9rem"},children:[e.jsx("strong",{children:"Preset:"})," ",R.name]}),e.jsxs(r,{sx:{color:t.text.primary,fontSize:"0.9rem"},children:[e.jsx("strong",{children:"Machines:"})," ",i.machine_ids.length," selected"]}),e.jsxs(r,{sx:{color:t.text.primary,fontSize:"0.9rem"},children:[e.jsx("strong",{children:"Args:"})," ",We()||i.args||"(none)"]})]})]})})]})]})]}),e.jsxs(ve,{sx:{p:2,borderTop:`1px solid ${t.border.light}`,justifyContent:"space-between"},children:[e.jsx(o,{children:M>0&&!C&&e.jsx(_,{startIcon:e.jsx(Me,{}),onClick:()=>I(s=>s-1),sx:{color:t.text.secondary},children:"Back"})}),e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx(_,{onClick:()=>W(!1),sx:{color:t.text.secondary},children:"Cancel"}),M<3&&!C?e.jsx(_,{endIcon:e.jsx(jt,{}),onClick:()=>I(s=>s+1),disabled:!X(),sx:{background:X()?se.primary:"rgba(255,255,255,0.1)",color:X()?"#0a0a0f":t.text.disabled,fontWeight:600,borderRadius:"10px"},children:"Next"}):e.jsx(_,{startIcon:e.jsx(yt,{}),onClick:Ve,disabled:!X(),sx:{background:X()?se.primary:"rgba(255,255,255,0.1)",color:X()?"#0a0a0f":t.text.disabled,fontWeight:600,borderRadius:"10px"},children:C?"Update Job":"Create Job"})]})]})]}),e.jsx(Rt,{open:L.open,autoHideDuration:3e3,onClose:()=>D({...L,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(ne,{severity:L.severity,onClose:()=>D({...L,open:!1}),children:L.message})})]})};export{Cs as default};
